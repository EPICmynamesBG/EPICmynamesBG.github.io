function GridStyle(){}var app=angular.module("app",["ui.router","ngAnimate"]);app.run(function($rootScope,$state,$timeout,$preload){$rootScope.endAnimation=!1,$timeout(function(){$rootScope.endAnimation=!0},3300),$rootScope.$state=$state,$rootScope.loading=!1,$rootScope.modalData={},$(".button-collapse").sideNav({closeOnClick:!0}),$rootScope.$on("$stateChangeStart",function(evt,to,params){to.redirectTo&&(evt.preventDefault(),$state.go(to.redirectTo,params,{location:"replace"}))})}),app.config(function($stateProvider,$urlRouterProvider,$locationProvider){$locationProvider.html5Mode({enabled:!0,requireBase:!0}),$urlRouterProvider.otherwise("/"),$stateProvider.state("Home",{url:"/",templateUrl:"views/home.html",controller:"HomeController",data:{}}).state("About",{url:"/about",templateUrl:"views/about.html",controller:"AboutController",data:{}}).state("Experience",{url:"/experience",templateUrl:"views/experience.html",controller:"ExperienceController",data:{}}).state("Projects",{url:"/projects",templateUrl:"views/projects.html",controller:"ProjectsController",redirectTo:"Projects.All",data:{}}).state("Projects.All",{parent:"Projects",project:"/all",url:"/all?style",templateUrl:"views/projects/all.html",controller:"ProjectsAllController",data:{}}).state("Projects.Detail",{parent:"Projects",url:"/:projectName",templateUrl:"views/projects/details.html",controller:"ProjectsDetailsController",data:{}})}),app.controller("AboutController",function($scope,$json){$json.loadFile("information/general").success(function(data){$scope.generalInfo=data}).error(function(error){console.log(error)})}),app.controller("ExperienceController",function($scope,$json){$json.loadFile("information/work").success(function(data){$scope.workHistory=data,$(".collapsible").collapsible()}).error(function(error){console.log(error)})}),app.controller("HomeController",function($scope){}),app.controller("NavController",function($scope){$(".button-collapse").sideNav({closeOnClick:!0})}),app.controller("ProjectsAllController",function($scope,$json,$stateParams,$state){$stateParams.style&&""!=$stateParams.style||($stateParams.style="tiles",$state.go("Projects.All",{style:$stateParams.style},{notify:!1,location:"replace"})),$scope.gridStyle=$stateParams.style,$json.loadFile("projects").success(function(data){$scope.projectList=data}).error(function(error){console.log(error)}),$scope.$watch("gridStyle",function(newVal,oldVal){newVal!=oldVal&&$state.go("Projects.All",{style:newVal},{notify:!1,location:"replace"})})}),app.controller("ProjectsController",function($scope,$json){}),app.controller("ProjectsDetailsController",function($scope,$stateParams,$json,$sce){var title=$json.formatTitle($stateParams.projectName);$json.loadFile("projects/"+title).then(function(response){$scope.project=response.data},function(response){$json.errorResponse(response)})}),app.directive("backToTop",function(){return{restrict:"E",replace:!0,scope:{},template:'<div id="goToTop" class="btn btn-floating waves-effect waves-light" ng-click="toTop()"><i class="material-icons">keyboard_arrow_up</i></div>',link:function(scope,element,attrs){$(window).scroll(function(){$(this).scrollTop()>100?element.addClass("show"):element.removeClass("show")}),scope.toTop=function(){return $("html, body").animate({scrollTop:0},600),!1}}}}),app.directive("carousel",function($interval){return{restrict:"A",replace:!0,scope:{imageArray:"="},templateUrl:"./views/directives/carousel.html",link:function(scope,element,attrs){var self=this;scope.paused=!1,scope.carouselIndex=0;var carouselTime=4500,init=function(){self.carousel&&$interval.cancel(self.carousel),self.carousel=$interval(function(){scope.paused||(scope.carouselIndex+=1,scope.imageArray.length==scope.carouselIndex&&(scope.carouselIndex=0))},carouselTime)};scope.$watch("imageArray",function(newValue){newValue&&init()}),scope.togglePlayback=function(){scope.paused=!scope.paused}}}}),GridStyle.List="list",GridStyle.Tiles="grid",app.directive("grid",function(){return{restrict:"E",replace:!0,transclude:!1,scope:{data:"=",gridStyle:"="},templateUrl:"./views/directives/grid.html",link:function(scope,element,attrs){scope.gridStyle||(scope.gridStyle=GridStyle.Tiles),scope.setStyle=function(newStyle){scope.gridStyle=newStyle}}}}),app.directive("gridList",function(){return{restrict:"E",replace:!0,scope:{project:"="},templateUrl:"./views/directives/grid-list.html",link:function(scope,element,attrs){}}}),app.directive("gridTile",function(){return{restrict:"E",replace:!0,scope:{project:"="},templateUrl:"./views/directives/grid-tile.html",link:function(scope,element,attrs){}}}),app.directive("mAppLoading",function($animate,$rootScope){function link(scope,element,attributes){$animate.enabled(!0),$rootScope.$watch("endAnimation",function(newVal){newVal&&$animate.leave(element.children().eq(1)).then(function(){element.remove(),scope=element=attributes=null})})}return{link:link,restrict:"C"}}),app.directive("navigation",function(){return{restrict:"E",transclude:!1,scope:{project:"="},templateUrl:"./views/directives/navigation.html",link:function(scope,element,attrs){},controller:"NavController"}}),app.filter("rawHtml",["$sce",function($sce){return function(val){return $sce.trustAsHtml(val)}}]),app.service("$json",function($http){var location="json/",toTitleCase=function(str){return str.replace(/\w\S*/g,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase()})};this.formatTitle=function(title){var temp=toTitleCase(title);return temp=temp.replace(/ /g,""),temp=temp.replace("(",""),temp=temp.replace(")",""),temp=temp.replace(/-/g,"")},this.loadFile=function(filename){return $http.get(location+filename+".json")},this.errorResponse=function(error){alert("An error occured loading the remote data. Please reload the page to try again."),console.log(error)}}),app.service("$preload",function($templateCache,$http){var views=["about","experience","home","projects","directives/carousel","directives/grid-list","directives/grid-tile","directives/grid","directives/navigation","projects/all","projects/details"],json=["information/general","information/work","projects"],projJson=["projects/AsteroidBlaster","projects/CharlieEatsWorms","projects/Godex","projects/Hackolantern","projects/Inbetween","projects/PlexmediaServer","projects/Pokemondb","projects/SimpleStudentDb","projects/Skbutton","projects/VirtualCommencementAdmin","projects/Wifiusb"],loadImages=function(jsonFile){for(var promArray=[],i=0;i<jsonFile.images.length;i++){var url=jsonFile.images[i],prom=$http.get("/assets/projects/"+url);promArray.push(prom)}return Promise.all(promArray)};this.loadAll=function(){var masterProm=new Promise(function(resolve,reject){for(var promArray=[],i=0;i<views.length;i++){var thisdir=views[i],prom=$http.get("views/"+thisdir+".html");promArray.push(prom)}for(var i=0;i<projJson.length;i++){var thisdir=projJson[i],prom=new Promise(function(resolve,reject){$http.get("json/"+thisdir+".json").then(function(response){var imgProm=loadImages(response.data);imgProm.then(function(values){values.push(response),resolve(values)},function(err){reject(err)})},function(error){reject(error)})});promArray.push(prom)}for(var i=0;i<json.length;i++){var thisdir=json[i],prom=$http.get("json/"+thisdir+".json");promArray.push(prom)}Promise.all(promArray).then(function(values){values.forEach(function(response){Array.isArray(response)?response.forEach(function(innerResponse){$templateCache.put(innerResponse.config.url,innerResponse.data)}):$templateCache.put(response.config.url,response.data)}),resolve("Success")},function(err){console.log(err),resolve(err)})});return masterProm}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRpcmVjdGl2ZXMvZ3JpZC5qcyIsImFwcC5qcyIsImNvbnRyb2xsZXJzL0Fib3V0Q29udHJvbGxlci5qcyIsImNvbnRyb2xsZXJzL0V4cGVyaWVuY2VDb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvSG9tZUNvbnRyb2xsZXIuanMiLCJjb250cm9sbGVycy9OYXZDb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvUHJvamVjdHNBbGxDb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvUHJvamVjdHNDb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvUHJvamVjdHNEZXRhaWxzQ29udHJvbGxlci5qcyIsImRpcmVjdGl2ZXMvYmFja1RvVG9wLmpzIiwiZGlyZWN0aXZlcy9jYXJvdXNlbC5qcyIsImRpcmVjdGl2ZXMvZ3JpZExpc3QuanMiLCJkaXJlY3RpdmVzL2dyaWRUaWxlLmpzIiwiZGlyZWN0aXZlcy9tQXBwTG9hZGluZy5qcyIsImRpcmVjdGl2ZXMvbmF2aWdhdGlvbi5qcyIsImZpbHRlcnMvcmF3SHRtbC5qcyIsInNlcnZpY2VzL2pzb24uanMiLCJzZXJ2aWNlcy9wcmVsb2FkLmpzIl0sIm5hbWVzIjpbIkdyaWRTdHlsZSIsImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJydW4iLCIkcm9vdFNjb3BlIiwiJHN0YXRlIiwiJHRpbWVvdXQiLCIkcHJlbG9hZCIsImVuZEFuaW1hdGlvbiIsImxvYWRpbmciLCJtb2RhbERhdGEiLCIkIiwic2lkZU5hdiIsImNsb3NlT25DbGljayIsIiRvbiIsImV2dCIsInRvIiwicGFyYW1zIiwicmVkaXJlY3RUbyIsInByZXZlbnREZWZhdWx0IiwiZ28iLCJsb2NhdGlvbiIsImNvbmZpZyIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJodG1sNU1vZGUiLCJlbmFibGVkIiwicmVxdWlyZUJhc2UiLCJvdGhlcndpc2UiLCJzdGF0ZSIsInVybCIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsImRhdGEiLCJwYXJlbnQiLCJwcm9qZWN0IiwiJHNjb3BlIiwiJGpzb24iLCJsb2FkRmlsZSIsInN1Y2Nlc3MiLCJnZW5lcmFsSW5mbyIsImVycm9yIiwiY29uc29sZSIsImxvZyIsIndvcmtIaXN0b3J5IiwiY29sbGFwc2libGUiLCIkc3RhdGVQYXJhbXMiLCJzdHlsZSIsIm5vdGlmeSIsImdyaWRTdHlsZSIsInByb2plY3RMaXN0IiwiJHdhdGNoIiwibmV3VmFsIiwib2xkVmFsIiwiJHNjZSIsInRpdGxlIiwiZm9ybWF0VGl0bGUiLCJwcm9qZWN0TmFtZSIsInRoZW4iLCJyZXNwb25zZSIsImVycm9yUmVzcG9uc2UiLCJkaXJlY3RpdmUiLCJyZXN0cmljdCIsInJlcGxhY2UiLCJzY29wZSIsInRlbXBsYXRlIiwibGluayIsImVsZW1lbnQiLCJhdHRycyIsIndpbmRvdyIsInNjcm9sbCIsInRoaXMiLCJzY3JvbGxUb3AiLCJhZGRDbGFzcyIsInJlbW92ZUNsYXNzIiwidG9Ub3AiLCJhbmltYXRlIiwiJGludGVydmFsIiwiaW1hZ2VBcnJheSIsInNlbGYiLCJwYXVzZWQiLCJjYXJvdXNlbEluZGV4IiwiY2Fyb3VzZWxUaW1lIiwiaW5pdCIsImNhcm91c2VsIiwiY2FuY2VsIiwibGVuZ3RoIiwibmV3VmFsdWUiLCJ0b2dnbGVQbGF5YmFjayIsIkxpc3QiLCJUaWxlcyIsInRyYW5zY2x1ZGUiLCJzZXRTdHlsZSIsIm5ld1N0eWxlIiwiJGFuaW1hdGUiLCJhdHRyaWJ1dGVzIiwibGVhdmUiLCJjaGlsZHJlbiIsImVxIiwicmVtb3ZlIiwiZmlsdGVyIiwidmFsIiwidHJ1c3RBc0h0bWwiLCJzZXJ2aWNlIiwiJGh0dHAiLCJ0b1RpdGxlQ2FzZSIsInN0ciIsInR4dCIsImNoYXJBdCIsInRvVXBwZXJDYXNlIiwic3Vic3RyIiwidG9Mb3dlckNhc2UiLCJ0ZW1wIiwiZmlsZW5hbWUiLCJnZXQiLCJhbGVydCIsIiR0ZW1wbGF0ZUNhY2hlIiwidmlld3MiLCJqc29uIiwicHJvakpzb24iLCJsb2FkSW1hZ2VzIiwianNvbkZpbGUiLCJwcm9tQXJyYXkiLCJpIiwiaW1hZ2VzIiwicHJvbSIsInB1c2giLCJQcm9taXNlIiwiYWxsIiwibG9hZEFsbCIsIm1hc3RlclByb20iLCJyZXNvbHZlIiwicmVqZWN0IiwidGhpc2RpciIsImltZ1Byb20iLCJ2YWx1ZXMiLCJlcnIiLCJmb3JFYWNoIiwiQXJyYXkiLCJpc0FycmF5IiwiaW5uZXJSZXNwb25zZSIsInB1dCJdLCJtYXBwaW5ncyI6IkFBQUEsUUFBQUEsY0NBQSxHQUFBQyxLQUFBQyxRQUFBQyxPQUFBLE9BQUEsWUFBQSxhQVFBRixLQUFBRyxJQUFBLFNBQUFDLFdBQUFDLE9BQUFDLFNBQUFDLFVBQ0FILFdBQUFJLGNBQUEsRUFFQUYsU0FBQSxXQUNBRixXQUFBSSxjQUFBLEdBQ0EsTUFFQUosV0FBQUMsT0FBQUEsT0FDQUQsV0FBQUssU0FBQSxFQUNBTCxXQUFBTSxhQUNBQyxFQUFBLG9CQUFBQyxTQUNBQyxjQUFBLElBU0FULFdBQUFVLElBQUEsb0JBQUEsU0FBQUMsSUFBQUMsR0FBQUMsUUFDQUQsR0FBQUUsYUFDQUgsSUFBQUksaUJBQ0FkLE9BQUFlLEdBQUFKLEdBQUFFLFdBQUFELFFBQ0FJLFNBQUEsaUJBU0FyQixJQUFBc0IsT0FBQSxTQUFBQyxlQUFBQyxtQkFBQUMsbUJBRUFBLGtCQUFBQyxXQUNBQyxTQUFBLEVBQ0FDLGFBQUEsSUFHQUosbUJBQUFLLFVBQUEsS0FFQU4sZUFDQU8sTUFBQSxRQUNBQyxJQUFBLElBQ0FDLFlBQUEsa0JBQ0FDLFdBQUEsaUJBQ0FDLFVBRUFKLE1BQUEsU0FDQUMsSUFBQSxTQUNBQyxZQUFBLG1CQUNBQyxXQUFBLGtCQUNBQyxVQUVBSixNQUFBLGNBQ0FDLElBQUEsY0FDQUMsWUFBQSx3QkFDQUMsV0FBQSx1QkFDQUMsVUFFQUosTUFBQSxZQUNBQyxJQUFBLFlBQ0FDLFlBQUEsc0JBQ0FDLFdBQUEscUJBQ0FmLFdBQUEsZUFDQWdCLFVBRUFKLE1BQUEsZ0JBQ0FLLE9BQUEsV0FDQUMsUUFBQSxPQUNBTCxJQUFBLGFBQ0FDLFlBQUEsMEJBQ0FDLFdBQUEsd0JBQ0FDLFVBRUFKLE1BQUEsbUJBQ0FLLE9BQUEsV0FDQUosSUFBQSxnQkFDQUMsWUFBQSw4QkFDQUMsV0FBQSw0QkFDQUMsWUN6RkFsQyxJQUFBaUMsV0FBQSxrQkFBQSxTQUFBSSxPQUFBQyxPQUVBQSxNQUFBQyxTQUFBLHVCQUNBQyxRQUFBLFNBQUFOLE1BQ0FHLE9BQUFJLFlBQUFQLE9BRUFRLE1BQUEsU0FBQUEsT0FDQUMsUUFBQUMsSUFBQUYsV0NQQTFDLElBQUFpQyxXQUFBLHVCQUFBLFNBQUFJLE9BQUFDLE9BQ0FBLE1BQUFDLFNBQUEsb0JBQ0FDLFFBQUEsU0FBQU4sTUFDQUcsT0FBQVEsWUFBQVgsS0FDQXZCLEVBQUEsZ0JBQUFtQyxnQkFFQUosTUFBQSxTQUFBQSxPQUNBQyxRQUFBQyxJQUFBRixXQ1BBMUMsSUFBQWlDLFdBQUEsaUJBQUEsU0FBQUksV0NBQXJDLElBQUFpQyxXQUFBLGdCQUFBLFNBQUFJLFFBRUExQixFQUFBLG9CQUFBQyxTQUNBQyxjQUFBLE1DSEFiLElBQUFpQyxXQUFBLHdCQUFBLFNBQUFJLE9BQUFDLE1BQUFTLGFBQUExQyxRQUVBMEMsYUFBQUMsT0FBQSxJQUFBRCxhQUFBQyxRQUNBRCxhQUFBQyxNQUFBLFFBRUEzQyxPQUFBZSxHQUFBLGdCQUNBNEIsTUFBQUQsYUFBQUMsUUFFQUMsUUFBQSxFQUNBNUIsU0FBQSxhQUlBZ0IsT0FBQWEsVUFBQUgsYUFBQUMsTUFFQVYsTUFBQUMsU0FBQSxZQUNBQyxRQUFBLFNBQUFOLE1BQ0FHLE9BQUFjLFlBQUFqQixPQUVBUSxNQUFBLFNBQUFBLE9BQ0FDLFFBQUFDLElBQUFGLFNBSUFMLE9BQUFlLE9BQUEsWUFBQSxTQUFBQyxPQUFBQyxRQUNBRCxRQUFBQyxRQUNBakQsT0FBQWUsR0FBQSxnQkFDQTRCLE1BQUFLLFNBRUFKLFFBQUEsRUFDQTVCLFNBQUEsZ0JDOUJBckIsSUFBQWlDLFdBQUEscUJBQUEsU0FBQUksT0FBQUMsVUNBQXRDLElBQUFpQyxXQUFBLDRCQUFBLFNBQUFJLE9BQUFVLGFBQUFULE1BQUFpQixNQUVBLEdBQUFDLE9BQUFsQixNQUFBbUIsWUFBQVYsYUFBQVcsWUFFQXBCLE9BQUFDLFNBQUEsWUFBQWlCLE9BQ0FHLEtBQUEsU0FBQUMsVUFDQXZCLE9BQUFELFFBQUF3QixTQUFBMUIsTUFDQSxTQUFBMEIsVUFDQXRCLE1BQUF1QixjQUFBRCxjQ1JBNUQsSUFBQThELFVBQUEsWUFBQSxXQUNBLE9BQ0FDLFNBQUEsSUFDQUMsU0FBQSxFQUNBQyxTQUNBQyxTQUFBLCtJQUNBQyxLQUFBLFNBQUFGLE1BQUFHLFFBQUFDLE9BRUExRCxFQUFBMkQsUUFBQUMsT0FBQSxXQUNBNUQsRUFBQTZELE1BQUFDLFlBQUEsSUFDQUwsUUFBQU0sU0FBQSxRQUVBTixRQUFBTyxZQUFBLFVBSUFWLE1BQUFXLE1BQUEsV0FJQSxNQUhBakUsR0FBQSxjQUFBa0UsU0FDQUosVUFBQSxHQUNBLE1BQ0EsT0NwQkF6RSxJQUFBOEQsVUFBQSxXQUFBLFNBQUFnQixXQUNBLE9BQ0FmLFNBQUEsSUFDQUMsU0FBQSxFQUNBQyxPQUNBYyxXQUFBLEtBRUEvQyxZQUFBLG1DQUNBbUMsS0FBQSxTQUFBRixNQUFBRyxRQUFBQyxPQUVBLEdBQUFXLE1BQUFSLElBRUFQLE9BQUFnQixRQUFBLEVBSUFoQixNQUFBaUIsY0FBQSxDQUVBLElBQUFDLGNBQUEsS0FFQUMsS0FBQSxXQUNBSixLQUFBSyxVQUNBUCxVQUFBUSxPQUFBTixLQUFBSyxVQUdBTCxLQUFBSyxTQUFBUCxVQUFBLFdBQ0FiLE1BQUFnQixTQUdBaEIsTUFBQWlCLGVBQUEsRUFDQWpCLE1BQUFjLFdBQUFRLFFBQUF0QixNQUFBaUIsZ0JBQ0FqQixNQUFBaUIsY0FBQSxLQUVBQyxjQUdBbEIsT0FBQWIsT0FBQSxhQUFBLFNBQUFvQyxVQUNBQSxVQUNBSixTQVNBbkIsTUFBQXdCLGVBQUEsV0FDQXhCLE1BQUFnQixRQUFBaEIsTUFBQWdCLFlWOUNBbEYsVUFBQTJGLEtBQUEsT0FFQTNGLFVBQUE0RixNQUFBLE9BRUEzRixJQUFBOEQsVUFBQSxPQUFBLFdBQ0EsT0FDQUMsU0FBQSxJQUNBQyxTQUFBLEVBQ0E0QixZQUFBLEVBQ0EzQixPQUNBL0IsS0FBQSxJQUNBZ0IsVUFBQSxLQUVBbEIsWUFBQSwrQkFDQW1DLEtBQUEsU0FBQUYsTUFBQUcsUUFBQUMsT0FDQUosTUFBQWYsWUFDQWUsTUFBQWYsVUFBQW5ELFVBQUE0RixPQUdBMUIsTUFBQTRCLFNBQUEsU0FBQUMsVUFDQTdCLE1BQUFmLFVBQUE0QyxjV3RCQTlGLElBQUE4RCxVQUFBLFdBQUEsV0FDQSxPQUNBQyxTQUFBLElBQ0FDLFNBQUEsRUFDQUMsT0FDQTdCLFFBQUEsS0FFQUosWUFBQSxvQ0FDQW1DLEtBQUEsU0FBQUYsTUFBQUcsUUFBQUMsWUNSQXJFLElBQUE4RCxVQUFBLFdBQUEsV0FDQSxPQUNBQyxTQUFBLElBQ0FDLFNBQUEsRUFDQUMsT0FDQTdCLFFBQUEsS0FFQUosWUFBQSxvQ0FDQW1DLEtBQUEsU0FBQUYsTUFBQUcsUUFBQUMsWUNSQXJFLElBQUE4RCxVQUFBLGNBQUEsU0FBQWlDLFNBQUEzRixZQUVBLFFBQUErRCxNQUFBRixNQUFBRyxRQUFBNEIsWUFPQUQsU0FBQXBFLFNBQUEsR0FFQXZCLFdBQUFnRCxPQUFBLGVBQUEsU0FBQUMsUUFDQUEsUUFDQTBDLFNBQUFFLE1BQUE3QixRQUFBOEIsV0FBQUMsR0FBQSxJQUFBeEMsS0FDQSxXQUVBUyxRQUFBZ0MsU0FFQW5DLE1BQUFHLFFBQUE0QixXQUFBLFNBVUEsT0FDQTdCLEtBQUFBLEtBQ0FKLFNBQUEsT0M5QkEvRCxJQUFBOEQsVUFBQSxhQUFBLFdBQ0EsT0FDQUMsU0FBQSxJQUNBNkIsWUFBQSxFQUNBM0IsT0FDQTdCLFFBQUEsS0FFQUosWUFBQSxxQ0FDQW1DLEtBQUEsU0FBQUYsTUFBQUcsUUFBQUMsU0FHQXBDLFdBQUEsbUJDWEFqQyxJQUFBcUcsT0FBQSxXQUFBLE9BQUEsU0FBQTlDLE1BQ0EsTUFBQSxVQUFBK0MsS0FDQSxNQUFBL0MsTUFBQWdELFlBQUFELFNDRkF0RyxJQUFBd0csUUFBQSxRQUFBLFNBQUFDLE9BRUEsR0FBQXBGLFVBQUEsUUFFQXFGLFlBQUEsU0FBQUMsS0FDQSxNQUFBQSxLQUFBM0MsUUFBQSxTQUFBLFNBQUE0QyxLQUNBLE1BQUFBLEtBQUFDLE9BQUEsR0FBQUMsY0FBQUYsSUFBQUcsT0FBQSxHQUFBQyxnQkFJQXhDLE1BQUFmLFlBQUEsU0FBQUQsT0FDQSxHQUFBeUQsTUFBQVAsWUFBQWxELE1BS0EsT0FKQXlELE1BQUFBLEtBQUFqRCxRQUFBLEtBQUEsSUFDQWlELEtBQUFBLEtBQUFqRCxRQUFBLElBQUEsSUFDQWlELEtBQUFBLEtBQUFqRCxRQUFBLElBQUEsSUFDQWlELEtBQUFBLEtBQUFqRCxRQUFBLEtBQUEsS0FJQVEsS0FBQWpDLFNBQUEsU0FBQTJFLFVBQ0EsTUFBQVQsT0FBQVUsSUFBQTlGLFNBQUE2RixTQUFBLFVBR0ExQyxLQUFBWCxjQUFBLFNBQUFuQixPQUNBMEUsTUFBQSxrRkFDQXpFLFFBQUFDLElBQUFGLFVDekJBMUMsSUFBQXdHLFFBQUEsV0FBQSxTQUFBYSxlQUFBWixPQUVBLEdBRUFhLFFBQ0EsUUFDQSxhQUNBLE9BQ0EsV0FDQSxzQkFDQSx1QkFDQSx1QkFDQSxrQkFDQSx3QkFDQSxlQUNBLG9CQUdBQyxNQUNBLHNCQUlBLG1CQUVBLFlBR0FDLFVBQ0EsMkJBSUEsNEJBRUEsaUJBQ0Esd0JBQ0EscUJBSUEsMkJBQ0EscUJBQ0EsMkJBQ0Esb0JBQ0Esb0NBQ0Esb0JBVUFDLFdBQUEsU0FBQUMsVUFFQSxJQUFBLEdBREFDLGNBQ0FDLEVBQUEsRUFBQUEsRUFBQUYsU0FBQUcsT0FBQXRDLE9BQUFxQyxJQUFBLENBQ0EsR0FBQTdGLEtBQUEyRixTQUFBRyxPQUFBRCxHQUNBRSxLQUFBckIsTUFBQVUsSUFBQSxvQkFBQXBGLElBQ0E0RixXQUFBSSxLQUFBRCxNQUVBLE1BQUFFLFNBQUFDLElBQUFOLFdBUUFuRCxNQUFBMEQsUUFBQSxXQUNBLEdBQUFDLFlBQUEsR0FBQUgsU0FBQSxTQUFBSSxRQUFBQyxRQUtBLElBQUEsR0FIQVYsY0FHQUMsRUFBQSxFQUFBQSxFQUFBTixNQUFBL0IsT0FBQXFDLElBQUEsQ0FDQSxHQUFBVSxTQUFBaEIsTUFBQU0sR0FDQUUsS0FBQXJCLE1BQUFVLElBQUEsU0FBQW1CLFFBQUEsUUFDQVgsV0FBQUksS0FBQUQsTUFJQSxJQUFBLEdBQUFGLEdBQUEsRUFBQUEsRUFBQUosU0FBQWpDLE9BQUFxQyxJQUFBLENBQ0EsR0FBQVUsU0FBQWQsU0FBQUksR0FDQUUsS0FBQSxHQUFBRSxTQUFBLFNBQUFJLFFBQUFDLFFBQ0E1QixNQUFBVSxJQUFBLFFBQUFtQixRQUFBLFNBQ0EzRSxLQUFBLFNBQUFDLFVBRUEsR0FBQTJFLFNBQUFkLFdBQUE3RCxTQUFBMUIsS0FDQXFHLFNBQUE1RSxLQUFBLFNBQUE2RSxRQUVBQSxPQUFBVCxLQUFBbkUsVUFDQXdFLFFBQUFJLFNBQ0EsU0FBQUMsS0FDQUosT0FBQUksUUFHQSxTQUFBL0YsT0FDQTJGLE9BQUEzRixVQUdBaUYsV0FBQUksS0FBQUQsTUFJQSxJQUFBLEdBQUFGLEdBQUEsRUFBQUEsRUFBQUwsS0FBQWhDLE9BQUFxQyxJQUFBLENBQ0EsR0FBQVUsU0FBQWYsS0FBQUssR0FDQUUsS0FBQXJCLE1BQUFVLElBQUEsUUFBQW1CLFFBQUEsUUFDQVgsV0FBQUksS0FBQUQsTUFJQUUsUUFBQUMsSUFBQU4sV0FBQWhFLEtBQUEsU0FBQTZFLFFBQ0FBLE9BQUFFLFFBQUEsU0FBQTlFLFVBQ0ErRSxNQUFBQyxRQUFBaEYsVUFDQUEsU0FBQThFLFFBQUEsU0FBQUcsZUFDQXhCLGVBQUF5QixJQUFBRCxjQUFBdkgsT0FBQVMsSUFBQThHLGNBQUEzRyxRQUdBbUYsZUFBQXlCLElBQUFsRixTQUFBdEMsT0FBQVMsSUFBQTZCLFNBQUExQixRQUdBa0csUUFBQSxZQUNBLFNBQUFLLEtBQ0E5RixRQUFBQyxJQUFBNkYsS0FDQUwsUUFBQUssUUFJQSxPQUFBTiIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gR3JpZFN0eWxlKCkgeyB9XG5cbkdyaWRTdHlsZS5MaXN0ID0gJ2xpc3QnO1xuXG5HcmlkU3R5bGUuVGlsZXMgPSAnZ3JpZCc7XG5cbmFwcC5kaXJlY3RpdmUoJ2dyaWQnLCBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdFJyxcbiAgICByZXBsYWNlOiB0cnVlLFxuICAgIHRyYW5zY2x1ZGU6IGZhbHNlLFxuICAgIHNjb3BlOiB7XG4gICAgICBkYXRhOiAnPScsXG4gICAgICBncmlkU3R5bGU6ICc9J1xuICAgIH0sXG4gICAgdGVtcGxhdGVVcmw6ICcuL3ZpZXdzL2RpcmVjdGl2ZXMvZ3JpZC5odG1sJyxcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpe1xuICAgICAgaWYgKCFzY29wZS5ncmlkU3R5bGUpe1xuICAgICAgICBzY29wZS5ncmlkU3R5bGUgPSBHcmlkU3R5bGUuVGlsZXM7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHNjb3BlLnNldFN0eWxlID0gZnVuY3Rpb24obmV3U3R5bGUpIHtcbiAgICAgICAgc2NvcGUuZ3JpZFN0eWxlID0gbmV3U3R5bGU7XG4gICAgICB9O1xuICAgICAgXG4gICAgfVxuLy8gICAgY29udHJvbGxlcjogJ05hdkNvbnRyb2xsZXInXG4gIH1cbn0pOyIsInZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJywgWyd1aS5yb3V0ZXInLCAnbmdBbmltYXRlJ10pO1xuXG4vL3NldFRpbWVvdXQoXG4vLyAgZnVuY3Rpb24gYXN5bmNCb290c3RyYXAoKSB7XG4vLyAgICBhbmd1bGFyLmJvb3RzdHJhcChkb2N1bWVudCwgW1wiYXBwXCJdKTtcbi8vICB9LCAoMy4zICogMTAwMClcbi8vKTtcblxuYXBwLnJ1bihmdW5jdGlvbiAoJHJvb3RTY29wZSwgJHN0YXRlLCAkdGltZW91dCwgJHByZWxvYWQpIHtcbiAgJHJvb3RTY29wZS5lbmRBbmltYXRpb24gPSBmYWxzZTtcblxuICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgJHJvb3RTY29wZS5lbmRBbmltYXRpb24gPSB0cnVlO1xuICB9LCAzMzAwKTsgLy8zLjNzZWNcblxuICAkcm9vdFNjb3BlLiRzdGF0ZSA9ICRzdGF0ZTtcbiAgJHJvb3RTY29wZS5sb2FkaW5nID0gZmFsc2U7XG4gICRyb290U2NvcGUubW9kYWxEYXRhID0ge307XG4gICQoXCIuYnV0dG9uLWNvbGxhcHNlXCIpLnNpZGVOYXYoe1xuICAgIGNsb3NlT25DbGljazogdHJ1ZVxuICB9KTtcblxuLy8gICRwcmVsb2FkLmxvYWRBbGwoKS50aGVuKGZ1bmN0aW9uIChzdWNjZXNzKSB7XG4vLyAgICBjb25zb2xlLmxvZyhcIlByZWxvYWRcIiwgc3VjY2Vzcyk7XG4vLyAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4vLyAgICBjb25zb2xlLmxvZyhcIlByZWxvYWRcIiwgZXJyb3IpO1xuLy8gIH0pO1xuXG4gICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdGFydCcsIGZ1bmN0aW9uIChldnQsIHRvLCBwYXJhbXMpIHtcbiAgICBpZiAodG8ucmVkaXJlY3RUbykge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAkc3RhdGUuZ28odG8ucmVkaXJlY3RUbywgcGFyYW1zLCB7XG4gICAgICAgIGxvY2F0aW9uOiAncmVwbGFjZSdcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG59KTtcblxuXG4vKiAtLS0gUm91dGluZyAtLS0gKi9cblxuYXBwLmNvbmZpZyhmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIpIHtcblxuICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUoe1xuICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgcmVxdWlyZUJhc2U6IHRydWVcbiAgfSk7XG5cbiAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZShcIi9cIik7XG5cbiAgJHN0YXRlUHJvdmlkZXJcbiAgICAuc3RhdGUoJ0hvbWUnLCB7XG4gICAgICB1cmw6ICcvJyxcbiAgICAgIHRlbXBsYXRlVXJsOiBcInZpZXdzL2hvbWUuaHRtbFwiLFxuICAgICAgY29udHJvbGxlcjogJ0hvbWVDb250cm9sbGVyJyxcbiAgICAgIGRhdGE6IHt9XG4gICAgfSlcbiAgICAuc3RhdGUoJ0Fib3V0Jywge1xuICAgICAgdXJsOiAnL2Fib3V0JyxcbiAgICAgIHRlbXBsYXRlVXJsOiBcInZpZXdzL2Fib3V0Lmh0bWxcIixcbiAgICAgIGNvbnRyb2xsZXI6ICdBYm91dENvbnRyb2xsZXInLFxuICAgICAgZGF0YToge31cbiAgICB9KVxuICAgIC5zdGF0ZSgnRXhwZXJpZW5jZScsIHtcbiAgICAgIHVybDogJy9leHBlcmllbmNlJyxcbiAgICAgIHRlbXBsYXRlVXJsOiBcInZpZXdzL2V4cGVyaWVuY2UuaHRtbFwiLFxuICAgICAgY29udHJvbGxlcjogJ0V4cGVyaWVuY2VDb250cm9sbGVyJyxcbiAgICAgIGRhdGE6IHt9XG4gICAgfSlcbiAgICAuc3RhdGUoJ1Byb2plY3RzJywge1xuICAgICAgdXJsOiBcIi9wcm9qZWN0c1wiLFxuICAgICAgdGVtcGxhdGVVcmw6IFwidmlld3MvcHJvamVjdHMuaHRtbFwiLFxuICAgICAgY29udHJvbGxlcjogJ1Byb2plY3RzQ29udHJvbGxlcicsXG4gICAgICByZWRpcmVjdFRvOiAnUHJvamVjdHMuQWxsJyxcbiAgICAgIGRhdGE6IHt9XG4gICAgfSlcbiAgICAuc3RhdGUoJ1Byb2plY3RzLkFsbCcsIHtcbiAgICAgIHBhcmVudDogJ1Byb2plY3RzJyxcbiAgICAgIHByb2plY3Q6ICcvYWxsJyxcbiAgICAgIHVybDogXCIvYWxsP3N0eWxlXCIsXG4gICAgICB0ZW1wbGF0ZVVybDogXCJ2aWV3cy9wcm9qZWN0cy9hbGwuaHRtbFwiLFxuICAgICAgY29udHJvbGxlcjogJ1Byb2plY3RzQWxsQ29udHJvbGxlcicsXG4gICAgICBkYXRhOiB7fVxuICAgIH0pXG4gICAgLnN0YXRlKCdQcm9qZWN0cy5EZXRhaWwnLCB7XG4gICAgICBwYXJlbnQ6ICdQcm9qZWN0cycsXG4gICAgICB1cmw6IFwiLzpwcm9qZWN0TmFtZVwiLFxuICAgICAgdGVtcGxhdGVVcmw6IFwidmlld3MvcHJvamVjdHMvZGV0YWlscy5odG1sXCIsXG4gICAgICBjb250cm9sbGVyOiAnUHJvamVjdHNEZXRhaWxzQ29udHJvbGxlcicsXG4gICAgICBkYXRhOiB7fVxuICAgIH0pO1xufSk7IiwiYXBwLmNvbnRyb2xsZXIoJ0Fib3V0Q29udHJvbGxlcicsIGZ1bmN0aW9uICgkc2NvcGUsICRqc29uKSB7XG5cbiAgJGpzb24ubG9hZEZpbGUoJ2luZm9ybWF0aW9uL2dlbmVyYWwnKVxuICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAkc2NvcGUuZ2VuZXJhbEluZm8gPSBkYXRhO1xuICAgIH0pXG4gICAgLmVycm9yKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgIH0pO1xuXG59KTsiLCJhcHAuY29udHJvbGxlcignRXhwZXJpZW5jZUNvbnRyb2xsZXInLCBmdW5jdGlvbiAoJHNjb3BlLCAkanNvbikge1xuICAkanNvbi5sb2FkRmlsZSgnaW5mb3JtYXRpb24vd29yaycpXG4gICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICRzY29wZS53b3JrSGlzdG9yeSA9IGRhdGE7XG4gICAgICAkKCcuY29sbGFwc2libGUnKS5jb2xsYXBzaWJsZSgpO1xuICAgIH0pXG4gICAgLmVycm9yKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgIH0pO1xufSk7IiwiYXBwLmNvbnRyb2xsZXIoJ0hvbWVDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlKXtcbiAgXG59KTsiLCJhcHAuY29udHJvbGxlcignTmF2Q29udHJvbGxlcicsIGZ1bmN0aW9uICgkc2NvcGUpIHtcblxuICAkKFwiLmJ1dHRvbi1jb2xsYXBzZVwiKS5zaWRlTmF2KHtcbiAgICBjbG9zZU9uQ2xpY2s6IHRydWVcbiAgfSk7XG5cbn0pOyIsImFwcC5jb250cm9sbGVyKCdQcm9qZWN0c0FsbENvbnRyb2xsZXInLCBmdW5jdGlvbiAoJHNjb3BlLCAkanNvbiwgJHN0YXRlUGFyYW1zLCAkc3RhdGUpIHtcblxuICBpZiAoISRzdGF0ZVBhcmFtcy5zdHlsZSB8fCAkc3RhdGVQYXJhbXMuc3R5bGUgPT0gXCJcIikge1xuICAgICRzdGF0ZVBhcmFtcy5zdHlsZSA9ICd0aWxlcyc7XG5cbiAgICAkc3RhdGUuZ28oJ1Byb2plY3RzLkFsbCcsIHtcbiAgICAgIHN0eWxlOiAkc3RhdGVQYXJhbXMuc3R5bGVcbiAgICB9LCB7XG4gICAgICBub3RpZnk6IGZhbHNlLFxuICAgICAgbG9jYXRpb246IFwicmVwbGFjZVwiXG4gICAgfSk7XG5cbiAgfTtcbiAgJHNjb3BlLmdyaWRTdHlsZSA9ICRzdGF0ZVBhcmFtcy5zdHlsZTtcblxuICAkanNvbi5sb2FkRmlsZSgncHJvamVjdHMnKVxuICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAkc2NvcGUucHJvamVjdExpc3QgPSBkYXRhO1xuICAgIH0pXG4gICAgLmVycm9yKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgIH0pO1xuXG5cbiAgJHNjb3BlLiR3YXRjaCgnZ3JpZFN0eWxlJywgZnVuY3Rpb24gKG5ld1ZhbCwgb2xkVmFsKSB7XG4gICAgaWYgKG5ld1ZhbCAhPSBvbGRWYWwpIHtcbiAgICAgICRzdGF0ZS5nbygnUHJvamVjdHMuQWxsJywge1xuICAgICAgICBzdHlsZTogbmV3VmFsXG4gICAgICB9LCB7XG4gICAgICAgIG5vdGlmeTogZmFsc2UsXG4gICAgICAgIGxvY2F0aW9uOiBcInJlcGxhY2VcIlxuICAgICAgfSk7XG4gICAgfVxuICB9KTtcblxuXG59KTsiLCJhcHAuY29udHJvbGxlcignUHJvamVjdHNDb250cm9sbGVyJywgZnVuY3Rpb24gKCRzY29wZSwgJGpzb24pIHtcblxufSk7IiwiYXBwLmNvbnRyb2xsZXIoJ1Byb2plY3RzRGV0YWlsc0NvbnRyb2xsZXInLCBmdW5jdGlvbiAoJHNjb3BlLCAkc3RhdGVQYXJhbXMsICRqc29uLCAkc2NlKSB7XG5cbiAgdmFyIHRpdGxlID0gJGpzb24uZm9ybWF0VGl0bGUoJHN0YXRlUGFyYW1zLnByb2plY3ROYW1lKTtcblxuICAkanNvbi5sb2FkRmlsZShcInByb2plY3RzL1wiICsgdGl0bGUpXG4gICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3BvbnNlKSB7XG4gICAgICAkc2NvcGUucHJvamVjdCA9IHJlc3BvbnNlLmRhdGE7XG4gICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgJGpzb24uZXJyb3JSZXNwb25zZShyZXNwb25zZSk7XG4gICAgfSk7XG5cblxuXG59KTsiLCJhcHAuZGlyZWN0aXZlKCdiYWNrVG9Ub3AnLCBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdFJyxcbiAgICByZXBsYWNlOiB0cnVlLFxuICAgIHNjb3BlOiB7fSxcbiAgICB0ZW1wbGF0ZTogJzxkaXYgaWQ9XCJnb1RvVG9wXCIgY2xhc3M9XCJidG4gYnRuLWZsb2F0aW5nIHdhdmVzLWVmZmVjdCB3YXZlcy1saWdodFwiIG5nLWNsaWNrPVwidG9Ub3AoKVwiPjxpIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnNcIj5rZXlib2FyZF9hcnJvd191cDwvaT48L2Rpdj4nLFxuICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcblxuICAgICAgJCh3aW5kb3cpLnNjcm9sbChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICgkKHRoaXMpLnNjcm9sbFRvcCgpID4gMTAwKSB7XG4gICAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnc2hvdycpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ3Nob3cnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHNjb3BlLnRvVG9wID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkKFwiaHRtbCwgYm9keVwiKS5hbmltYXRlKHtcbiAgICAgICAgICBzY3JvbGxUb3A6IDBcbiAgICAgICAgfSwgNjAwKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfTtcblxuICAgIH1cbiAgfVxufSk7IiwiYXBwLmRpcmVjdGl2ZSgnY2Fyb3VzZWwnLCBmdW5jdGlvbiAoJGludGVydmFsKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdBJyxcbiAgICByZXBsYWNlOiB0cnVlLFxuICAgIHNjb3BlOiB7XG4gICAgICBpbWFnZUFycmF5OiAnPSdcbiAgICB9LFxuICAgIHRlbXBsYXRlVXJsOiAnLi92aWV3cy9kaXJlY3RpdmVzL2Nhcm91c2VsLmh0bWwnLFxuICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcblxuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgXG4gICAgICBzY29wZS5wYXVzZWQgPSBmYWxzZTtcbiAgICAgIFxuLy8gICAgICBzY29wZS5mdWxsU2NyZWVuID0gZmFsc2U7XG5cbiAgICAgIHNjb3BlLmNhcm91c2VsSW5kZXggPSAwO1xuXG4gICAgICB2YXIgY2Fyb3VzZWxUaW1lID0gNDUwMDtcblxuICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChzZWxmLmNhcm91c2VsKSB7XG4gICAgICAgICAgJGludGVydmFsLmNhbmNlbChzZWxmLmNhcm91c2VsKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgc2VsZi5jYXJvdXNlbCA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgaWYgKHNjb3BlLnBhdXNlZCl7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIHNjb3BlLmNhcm91c2VsSW5kZXggKz0gMTtcbiAgICAgICAgICBpZiAoc2NvcGUuaW1hZ2VBcnJheS5sZW5ndGggPT0gc2NvcGUuY2Fyb3VzZWxJbmRleCkge1xuICAgICAgICAgICAgc2NvcGUuY2Fyb3VzZWxJbmRleCA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICB9LCBjYXJvdXNlbFRpbWUpO1xuICAgICAgfVxuXG4gICAgICBzY29wZS4kd2F0Y2goJ2ltYWdlQXJyYXknLCBmdW5jdGlvbiAobmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKG5ld1ZhbHVlKSB7XG4gICAgICAgICAgaW5pdCgpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuXG4gICAgICAvKipcbiAgICAgICAqIFRvZ2dsZSBQbGF5YmFjayBmdW5jdGlvbiwgc3RhcnRzL3BhdXNlcyBjYXJvdXNlbFxuICAgICAgICogQGF1dGhvciBCcmFuZG9uIEdyb2ZmXG4gICAgICAgKi9cbiAgICAgIHNjb3BlLnRvZ2dsZVBsYXliYWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBzY29wZS5wYXVzZWQgPSAhc2NvcGUucGF1c2VkO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvKipcbiAgICAgICAqIFRvZ2dsZSBGdWxsU2NyZWVuIGZ1bmN0aW9uLCBleHBhbmRzL3Nocmlua3MgY2Fyb3VzZWxcbiAgICAgICAqIEBhdXRob3IgQnJhbmRvbiBHcm9mZlxuICAgICAgICovXG4vLyAgICAgIHNjb3BlLnRvZ2dsZUZ1bGxzY3JlZW4gPSBmdW5jdGlvbiAoKSB7XG4vLyAgICAgICAgc2NvcGUuZnVsbFNjcmVlbiA9ICFzY29wZS5mdWxsU2NyZWVuO1xuLy8gICAgICB9XG5cbiAgICB9XG4gIH1cbn0pOyIsImFwcC5kaXJlY3RpdmUoJ2dyaWRMaXN0JywgZnVuY3Rpb24gKCkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnRScsXG4gICAgcmVwbGFjZTogdHJ1ZSxcbiAgICBzY29wZToge1xuICAgICAgcHJvamVjdDogJz0nXG4gICAgfSxcbiAgICB0ZW1wbGF0ZVVybDogJy4vdmlld3MvZGlyZWN0aXZlcy9ncmlkLWxpc3QuaHRtbCcsXG4gICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzKXtcbiAgICAgIFxuICAgIH1cbiAgfVxufSk7IiwiYXBwLmRpcmVjdGl2ZSgnZ3JpZFRpbGUnLCBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdFJyxcbiAgICByZXBsYWNlOiB0cnVlLFxuICAgIHNjb3BlOiB7XG4gICAgICBwcm9qZWN0OiAnPSdcbiAgICB9LFxuICAgIHRlbXBsYXRlVXJsOiAnLi92aWV3cy9kaXJlY3RpdmVzL2dyaWQtdGlsZS5odG1sJyxcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpe1xuICAgICAgXG4gICAgfVxuICB9XG59KTsiLCJhcHAuZGlyZWN0aXZlKFwibUFwcExvYWRpbmdcIiwgZnVuY3Rpb24gKCRhbmltYXRlLCAkcm9vdFNjb3BlKSB7XG5cbiAgZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbWVudCwgYXR0cmlidXRlcykge1xuICAgIC8vIER1ZSB0byB0aGUgd2F5IEFuZ3VsYXJKUyBwcmV2ZW50cyBhbmltYXRpb24gZHVyaW5nIHRoZSBib290c3RyYXBcbiAgICAvLyBvZiB0aGUgYXBwbGljYXRpb24sIHdlIGNhbid0IGFuaW1hdGUgdGhlIHRvcC1sZXZlbCBjb250YWluZXI7IGJ1dCxcbiAgICAvLyBzaW5jZSB3ZSBhZGRlZCBcIm5nQW5pbWF0ZUNoaWxkcmVuXCIsIHdlIGNhbiBhbmltYXRlZCB0aGUgaW5uZXJcbiAgICAvLyBjb250YWluZXIgZHVyaW5nIHRoaXMgcGhhc2UuXG4gICAgLy8gLS1cbiAgICAvLyBOT1RFOiBBbSB1c2luZyAuZXEoMSkgc28gdGhhdCB3ZSBkb24ndCBhbmltYXRlIHRoZSBTdHlsZSBibG9jay5cbiAgICAkYW5pbWF0ZS5lbmFibGVkKHRydWUpO1xuXG4gICAgJHJvb3RTY29wZS4kd2F0Y2goJ2VuZEFuaW1hdGlvbicsIGZ1bmN0aW9uIChuZXdWYWwpIHtcbiAgICAgIGlmIChuZXdWYWwpIHtcbiAgICAgICAgJGFuaW1hdGUubGVhdmUoZWxlbWVudC5jaGlsZHJlbigpLmVxKDEpKS50aGVuKFxuICAgICAgICAgIGZ1bmN0aW9uIGNsZWFudXBBZnRlckFuaW1hdGlvbigpIHtcbiAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgcm9vdCBkaXJlY3RpdmUgZWxlbWVudC5cbiAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlKCk7XG4gICAgICAgICAgICAvLyBDbGVhciB0aGUgY2xvc2VkLW92ZXIgdmFyaWFibGUgcmVmZXJlbmNlcy5cbiAgICAgICAgICAgIHNjb3BlID0gZWxlbWVudCA9IGF0dHJpYnV0ZXMgPSBudWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICB9O1xuXG5cbiAgLy8gUmV0dXJuIHRoZSBkaXJlY3RpdmUgY29uZmlndXJhdGlvbi5cbiAgcmV0dXJuICh7XG4gICAgbGluazogbGluayxcbiAgICByZXN0cmljdDogXCJDXCJcbiAgfSk7XG4gIC8vIEkgYmluZCB0aGUgSmF2YVNjcmlwdCBldmVudHMgdG8gdGhlIHNjb3BlLlxuXG59KTsiLCJhcHAuZGlyZWN0aXZlKCduYXZpZ2F0aW9uJywgZnVuY3Rpb24gKCkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnRScsXG4gICAgdHJhbnNjbHVkZTogZmFsc2UsXG4gICAgc2NvcGU6IHtcbiAgICAgIHByb2plY3Q6IFwiPVwiXG4gICAgfSxcbiAgICB0ZW1wbGF0ZVVybDogJy4vdmlld3MvZGlyZWN0aXZlcy9uYXZpZ2F0aW9uLmh0bWwnLFxuICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycyl7XG4gICAgICBcbiAgICB9LFxuICAgIGNvbnRyb2xsZXI6ICdOYXZDb250cm9sbGVyJ1xuICB9XG59KTsiLCJhcHAuZmlsdGVyKCdyYXdIdG1sJywgWyckc2NlJywgZnVuY3Rpb24gKCRzY2UpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICh2YWwpIHtcbiAgICByZXR1cm4gJHNjZS50cnVzdEFzSHRtbCh2YWwpO1xuICB9O1xufV0pOyIsImFwcC5zZXJ2aWNlKFwiJGpzb25cIiwgZnVuY3Rpb24gKCRodHRwKSB7XG5cbiAgdmFyIGxvY2F0aW9uID0gXCJqc29uL1wiO1xuXG4gIHZhciB0b1RpdGxlQ2FzZSA9IGZ1bmN0aW9uIChzdHIpIHtcbiAgICByZXR1cm4gc3RyLnJlcGxhY2UoL1xcd1xcUyovZywgZnVuY3Rpb24gKHR4dCkge1xuICAgICAgcmV0dXJuIHR4dC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHR4dC5zdWJzdHIoMSkudG9Mb3dlckNhc2UoKTtcbiAgICB9KTtcbiAgfVxuXG4gIHRoaXMuZm9ybWF0VGl0bGUgPSBmdW5jdGlvbiAodGl0bGUpIHtcbiAgICB2YXIgdGVtcCA9IHRvVGl0bGVDYXNlKHRpdGxlKTtcbiAgICB0ZW1wID0gdGVtcC5yZXBsYWNlKC8gL2csIFwiXCIpO1xuICAgIHRlbXAgPSB0ZW1wLnJlcGxhY2UoXCIoXCIsIFwiXCIpO1xuICAgIHRlbXAgPSB0ZW1wLnJlcGxhY2UoXCIpXCIsIFwiXCIpO1xuICAgIHRlbXAgPSB0ZW1wLnJlcGxhY2UoLy0vZywgXCJcIik7XG4gICAgcmV0dXJuIHRlbXA7XG4gIH1cblxuICB0aGlzLmxvYWRGaWxlID0gZnVuY3Rpb24gKGZpbGVuYW1lKSB7XG4gICAgcmV0dXJuICRodHRwLmdldChsb2NhdGlvbiArIGZpbGVuYW1lICsgXCIuanNvblwiKTtcbiAgfVxuXG4gIHRoaXMuZXJyb3JSZXNwb25zZSA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgIGFsZXJ0KFwiQW4gZXJyb3Igb2NjdXJlZCBsb2FkaW5nIHRoZSByZW1vdGUgZGF0YS4gUGxlYXNlIHJlbG9hZCB0aGUgcGFnZSB0byB0cnkgYWdhaW4uXCIpO1xuICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgfVxufSk7IiwiYXBwLnNlcnZpY2UoXCIkcHJlbG9hZFwiLCBmdW5jdGlvbiAoJHRlbXBsYXRlQ2FjaGUsICRodHRwKSB7XG5cbiAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gIHZhciB2aWV3cyA9IFtcbiAgICAnYWJvdXQnLFxuICAgICdleHBlcmllbmNlJyxcbiAgICAnaG9tZScsXG4gICAgJ3Byb2plY3RzJyxcbiAgICAnZGlyZWN0aXZlcy9jYXJvdXNlbCcsXG4gICAgJ2RpcmVjdGl2ZXMvZ3JpZC1saXN0JyxcbiAgICAnZGlyZWN0aXZlcy9ncmlkLXRpbGUnLFxuICAgICdkaXJlY3RpdmVzL2dyaWQnLFxuICAgICdkaXJlY3RpdmVzL25hdmlnYXRpb24nLFxuICAgICdwcm9qZWN0cy9hbGwnLFxuICAgICdwcm9qZWN0cy9kZXRhaWxzJ1xuICBdO1xuXG4gIHZhciBqc29uID0gW1xuICAgICdpbmZvcm1hdGlvbi9nZW5lcmFsJyxcbi8vICAgICdpbmZvcm1hdGlvbi9pbnRlcmVzdHMnLFxuLy8gICAgJ2luZm9ybWF0aW9uL3BlcnNvbmFsaXR5VHJhaXRzJyxcbi8vICAgICdpbmZvcm1hdGlvbi9za2lsbHMnLFxuICAgICdpbmZvcm1hdGlvbi93b3JrJyxcbi8vICAgICdvbGRQcm9qZWN0cycsXG4gICAgJ3Byb2plY3RzJ1xuICBdO1xuXG4gIHZhciBwcm9qSnNvbiA9IFtcbiAgICAncHJvamVjdHMvQXN0ZXJvaWRCbGFzdGVyJyxcbi8vICAgICdwcm9qZWN0cy9BdWdtZW50ZWRSZWFsaXR5U2NhdmVuZ2VySHVudCcsXG4vLyAgICAncHJvamVjdHMvQm9tYm5hbnphJyxcbi8vICAgICdwcm9qZWN0cy9CdXp6ZWRCdWRkeScsXG4gICAgJ3Byb2plY3RzL0NoYXJsaWVFYXRzV29ybXMnLFxuLy8gICAgJ3Byb2plY3RzL0NvZGVPZktuaWdodGhvZGQnLFxuICAgICdwcm9qZWN0cy9Hb2RleCcsXG4gICAgJ3Byb2plY3RzL0hhY2tvbGFudGVybicsXG4gICAgJ3Byb2plY3RzL0luYmV0d2VlbicsXG4vLyAgICAncHJvamVjdHMvSW5iZXR3ZWVuaW9zJyxcbi8vICAgICdwcm9qZWN0cy9NY3Zlcmlsb2cnLFxuLy8gICAgJ3Byb2plY3RzL1BsYW50c0luU3BhY2UnLFxuICAgICdwcm9qZWN0cy9QbGV4bWVkaWFTZXJ2ZXInLFxuICAgICdwcm9qZWN0cy9Qb2tlbW9uZGInLFxuICAgICdwcm9qZWN0cy9TaW1wbGVTdHVkZW50RGInLFxuICAgICdwcm9qZWN0cy9Ta2J1dHRvbicsXG4gICAgJ3Byb2plY3RzL1ZpcnR1YWxDb21tZW5jZW1lbnRBZG1pbicsXG4gICAgJ3Byb2plY3RzL1dpZml1c2InXG4gIF1cblxuXG4gIC8qKlxuICAgKiBMb2FkIGFsbCBpbWFnZXMgZnJvbSB0aGUganNvblxuICAgKiBAYXV0aG9yIEJyYW5kb24gR3JvZmZcbiAgICogQHBhcmFtIHtPYmplY3R9ICBqc29uRmlsZSB0aGUgbG9hZGVkIGpzb24gZmlsZVxuICAgKiBAcmV0dXJucyB7UHJvbWlzZX0gYSBwcm9taXNlXG4gICAqL1xuICB2YXIgbG9hZEltYWdlcyA9IGZ1bmN0aW9uIChqc29uRmlsZSkge1xuICAgIHZhciBwcm9tQXJyYXkgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGpzb25GaWxlLmltYWdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIHVybCA9IGpzb25GaWxlLmltYWdlc1tpXTtcbiAgICAgIHZhciBwcm9tID0gJGh0dHAuZ2V0KCcvYXNzZXRzL3Byb2plY3RzLycgKyB1cmwpO1xuICAgICAgcHJvbUFycmF5LnB1c2gocHJvbSk7XG4gICAgfVxuICAgIHJldHVybiBQcm9taXNlLmFsbChwcm9tQXJyYXkpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBMb2FkIGFsbCB0ZW1wbGF0ZSBodG1sLGpzb24sIGFuZCBpbWFnZSBmaWxlcyBmb3IgZnV0dXJlIHVzZVxuICAgKiBAYXV0aG9yIEJyYW5kb24gR3JvZmZcbiAgICogQHJldHVybnMge1Byb21pc2V9IEEgUHJvbWlzZSB0aGF0IGFsd2F5cyByZXNvbHZlcyBzdWNjZXNzZnVsbHlcbiAgICovXG4gIHRoaXMubG9hZEFsbCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbWFzdGVyUHJvbSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgdmFyIHByb21BcnJheSA9IFtdO1xuXG4gICAgICAvL1ZpZXdzXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZpZXdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciB0aGlzZGlyID0gdmlld3NbaV07XG4gICAgICAgIHZhciBwcm9tID0gJGh0dHAuZ2V0KCd2aWV3cy8nICsgdGhpc2RpciArICcuaHRtbCcpO1xuICAgICAgICBwcm9tQXJyYXkucHVzaChwcm9tKTtcbiAgICAgIH1cblxuICAgICAgLy9Qcm9qSlNPTlxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9qSnNvbi5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgdGhpc2RpciA9IHByb2pKc29uW2ldO1xuICAgICAgICB2YXIgcHJvbSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAkaHR0cC5nZXQoJ2pzb24vJyArIHRoaXNkaXIgKyAnLmpzb24nKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgIC8vSW1hZ2VzXG4gICAgICAgICAgICAgIHZhciBpbWdQcm9tID0gbG9hZEltYWdlcyhyZXNwb25zZS5kYXRhKTtcbiAgICAgICAgICAgICAgaW1nUHJvbS50aGVuKGZ1bmN0aW9uKHZhbHVlcykge1xuICAgICAgICAgICAgICAgIC8vYWRkIHRoaXMgaXRlbSBvciBpdCB3b24ndCBnZXQgY2FjaGVkXG4gICAgICAgICAgICAgICAgdmFsdWVzLnB1c2gocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUodmFsdWVzKTtcbiAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgcHJvbUFycmF5LnB1c2gocHJvbSk7XG4gICAgICB9XG5cbiAgICAgIC8vSlNPTlxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBqc29uLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciB0aGlzZGlyID0ganNvbltpXTtcbiAgICAgICAgdmFyIHByb20gPSAkaHR0cC5nZXQoJ2pzb24vJyArIHRoaXNkaXIgKyAnLmpzb24nKTtcbiAgICAgICAgcHJvbUFycmF5LnB1c2gocHJvbSk7XG4gICAgICB9XG5cbiAgICAgIC8vRklOQUxMWSAtPiBzYXZlIHRoZW0gQUxMTExcbiAgICAgIFByb21pc2UuYWxsKHByb21BcnJheSkudGhlbihmdW5jdGlvbih2YWx1ZXMpIHtcbiAgICAgICAgdmFsdWVzLmZvckVhY2goZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocmVzcG9uc2UpKSB7XG4gICAgICAgICAgICByZXNwb25zZS5mb3JFYWNoKGZ1bmN0aW9uIChpbm5lclJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICR0ZW1wbGF0ZUNhY2hlLnB1dChpbm5lclJlc3BvbnNlLmNvbmZpZy51cmwsIGlubmVyUmVzcG9uc2UuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJHRlbXBsYXRlQ2FjaGUucHV0KHJlc3BvbnNlLmNvbmZpZy51cmwsIHJlc3BvbnNlLmRhdGEpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJlc29sdmUoJ1N1Y2Nlc3MnKTtcbiAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICByZXNvbHZlKGVycik7XG4gICAgICB9KTtcblxuICAgIH0pO1xuICAgIHJldHVybiBtYXN0ZXJQcm9tO1xuICB9O1xuXG59KTsiXX0=
