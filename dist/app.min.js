function GridStyle(){}var app=angular.module("app",["ui.router","ngAnimate"]);setTimeout(function(){angular.bootstrap(document,["app"])},10),app.run(function($rootScope,$state,$timeout,$preload){$rootScope.endAnimation=!1,$timeout(function(){$rootScope.endAnimation=!0},3300),$rootScope.$state=$state,$rootScope.loading=!1,$rootScope.modalData={},$(".button-collapse").sideNav({closeOnClick:!0}),$rootScope.$on("$stateChangeStart",function(evt,to,params){to.redirectTo&&(evt.preventDefault(),$state.go(to.redirectTo,params,{location:"replace"}))})}),app.config(function($stateProvider,$urlRouterProvider,$locationProvider){$locationProvider.html5Mode({enabled:!0,requireBase:!0}),$urlRouterProvider.otherwise("/"),$stateProvider.state("Home",{url:"/",templateUrl:"views/home.html",controller:"HomeController",data:{}}).state("About",{url:"/about",templateUrl:"views/about.html",controller:"AboutController",data:{}}).state("Experience",{url:"/experience",templateUrl:"views/experience.html",controller:"ExperienceController",data:{}}).state("Projects",{url:"/projects",templateUrl:"views/projects.html",controller:"ProjectsController",redirectTo:"Projects.All",data:{}}).state("Projects.All",{parent:"Projects",project:"/all",url:"/all?style",templateUrl:"views/projects/all.html",controller:"ProjectsAllController",data:{}}).state("Projects.Detail",{parent:"Projects",url:"/:projectName",templateUrl:"views/projects/details.html",controller:"ProjectsDetailsController",data:{}})}),app.controller("AboutController",function($scope,$json){$json.loadFile("information/general").success(function(data){$scope.generalInfo=data}).error(function(error){console.log(error)})}),app.controller("ExperienceController",function($scope,$json){$json.loadFile("information/work").success(function(data){$scope.workHistory=data,$(".collapsible").collapsible()}).error(function(error){console.log(error)})}),app.controller("HomeController",function($scope){}),app.controller("NavController",function($scope){$(".button-collapse").sideNav({closeOnClick:!0})}),app.controller("ProjectsAllController",function($scope,$json,$stateParams,$state){$stateParams.style&&""!=$stateParams.style||($stateParams.style="tiles",$state.go("Projects.All",{style:$stateParams.style},{notify:!1,location:"replace"})),$scope.gridStyle=$stateParams.style,$json.loadFile("projects").success(function(data){$scope.projectList=data}).error(function(error){console.log(error)}),$scope.$watch("gridStyle",function(newVal,oldVal){newVal!=oldVal&&$state.go("Projects.All",{style:newVal},{notify:!1,location:"replace"})})}),app.controller("ProjectsController",function($scope,$json){}),app.controller("ProjectsDetailsController",function($scope,$stateParams,$json,$sce){var title=$json.formatTitle($stateParams.projectName);$json.loadFile("projects/"+title).then(function(response){$scope.project=response.data},function(response){$json.errorResponse(response)})}),app.directive("backToTop",function(){return{restrict:"E",replace:!0,scope:{},template:'<div id="goToTop" class="btn btn-floating waves-effect waves-light" ng-click="toTop()"><i class="material-icons">keyboard_arrow_up</i></div>',link:function(scope,element,attrs){$(window).scroll(function(){$(this).scrollTop()>100?element.addClass("show"):element.removeClass("show"),$(window).width()<=750&&$(this).scrollTop()>=$(window).height()-1?element.addClass("upfix"):element.removeClass("upfix")}),scope.toTop=function(){return $("html, body").animate({scrollTop:0},600),!1}}}}),app.directive("carousel",function($interval){return{restrict:"A",replace:!0,scope:{imageArray:"="},templateUrl:"./views/directives/carousel.html",link:function(scope,element,attrs){var self=this;scope.paused=!1,scope.carouselIndex=0;var carouselTime=4500,init=function(){self.carousel&&$interval.cancel(self.carousel),self.carousel=$interval(function(){scope.paused||(scope.carouselIndex+=1,scope.imageArray.length==scope.carouselIndex&&(scope.carouselIndex=0))},carouselTime)};scope.$watch("imageArray",function(newValue){newValue&&init()}),scope.togglePlayback=function(){scope.paused=!scope.paused}}}}),GridStyle.List="list",GridStyle.Tiles="grid",app.directive("grid",function(){return{restrict:"E",replace:!0,transclude:!1,scope:{data:"=",gridStyle:"="},templateUrl:"./views/directives/grid.html",link:function(scope,element,attrs){scope.gridStyle||(scope.gridStyle=GridStyle.Tiles),scope.setStyle=function(newStyle){scope.gridStyle=newStyle}}}}),app.directive("gridList",function(){return{restrict:"E",replace:!0,scope:{project:"="},templateUrl:"./views/directives/grid-list.html",link:function(scope,element,attrs){}}}),app.directive("gridTile",function(){return{restrict:"E",replace:!0,scope:{project:"="},templateUrl:"./views/directives/grid-tile.html",link:function(scope,element,attrs){}}}),app.directive("mAppLoading",function($animate,$rootScope){function link(scope,element,attributes){$animate.enabled(!0),$rootScope.$watch("endAnimation",function(newVal){newVal&&$animate.leave(element.children().eq(1)).then(function(){element.remove(),scope=element=attributes=null})})}return{link:link,restrict:"C"}}),app.directive("navigation",function(){return{restrict:"E",transclude:!1,scope:{project:"="},templateUrl:"./views/directives/navigation.html",link:function(scope,element,attrs){},controller:"NavController"}}),app.filter("rawHtml",["$sce",function($sce){return function(val){return $sce.trustAsHtml(val)}}]),app.service("$json",function($http){var location="json/",toTitleCase=function(str){return str.replace(/\w\S*/g,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase()})};this.formatTitle=function(title){var temp=toTitleCase(title);return temp=temp.replace(/ /g,""),temp=temp.replace("(",""),temp=temp.replace(")",""),temp=temp.replace(/-/g,"")},this.loadFile=function(filename){return $http.get(location+filename+".json")},this.errorResponse=function(error){alert("An error occured loading the remote data. Please reload the page to try again."),console.log(error)}}),app.service("$preload",function($templateCache,$http){var views=["about","experience","home","projects","directives/carousel","directives/grid-list","directives/grid-tile","directives/grid","directives/navigation","projects/all","projects/details"],json=["information/general","information/work","projects"],projJson=["projects/AsteroidBlaster","projects/CharlieEatsWorms","projects/Godex","projects/Hackolantern","projects/Inbetween","projects/PlexmediaServer","projects/Pokemondb","projects/SimpleStudentDb","projects/Skbutton","projects/VirtualCommencementAdmin","projects/Wifiusb"],loadImages=function(jsonFile){for(var promArray=[],i=0;i<jsonFile.images.length;i++){var url=jsonFile.images[i],prom=$http.get("/assets/projects/"+url);promArray.push(prom)}return Promise.all(promArray)};this.loadAll=function(){var masterProm=new Promise(function(resolve,reject){for(var promArray=[],i=0;i<views.length;i++){var thisdir=views[i],prom=$http.get("views/"+thisdir+".html");promArray.push(prom)}for(var i=0;i<projJson.length;i++){var thisdir=projJson[i],prom=new Promise(function(resolve,reject){$http.get("json/"+thisdir+".json").then(function(response){var imgProm=loadImages(response.data);imgProm.then(function(values){values.push(response),resolve(values)},function(err){reject(err)})},function(error){reject(error)})});promArray.push(prom)}for(var i=0;i<json.length;i++){var thisdir=json[i],prom=$http.get("json/"+thisdir+".json");promArray.push(prom)}Promise.all(promArray).then(function(values){values.forEach(function(response){Array.isArray(response)?response.forEach(function(innerResponse){$templateCache.put(innerResponse.config.url,innerResponse.data)}):$templateCache.put(response.config.url,response.data)}),resolve("Success")},function(err){console.log(err),resolve(err)})});return masterProm}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRpcmVjdGl2ZXMvZ3JpZC5qcyIsImFwcC5qcyIsImNvbnRyb2xsZXJzL0Fib3V0Q29udHJvbGxlci5qcyIsImNvbnRyb2xsZXJzL0V4cGVyaWVuY2VDb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvSG9tZUNvbnRyb2xsZXIuanMiLCJjb250cm9sbGVycy9OYXZDb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvUHJvamVjdHNBbGxDb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvUHJvamVjdHNDb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvUHJvamVjdHNEZXRhaWxzQ29udHJvbGxlci5qcyIsImRpcmVjdGl2ZXMvYmFja1RvVG9wLmpzIiwiZGlyZWN0aXZlcy9jYXJvdXNlbC5qcyIsImRpcmVjdGl2ZXMvZ3JpZExpc3QuanMiLCJkaXJlY3RpdmVzL2dyaWRUaWxlLmpzIiwiZGlyZWN0aXZlcy9tQXBwTG9hZGluZy5qcyIsImRpcmVjdGl2ZXMvbmF2aWdhdGlvbi5qcyIsImZpbHRlcnMvcmF3SHRtbC5qcyIsInNlcnZpY2VzL2pzb24uanMiLCJzZXJ2aWNlcy9wcmVsb2FkLmpzIl0sIm5hbWVzIjpbIkdyaWRTdHlsZSIsImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJzZXRUaW1lb3V0IiwiYm9vdHN0cmFwIiwiZG9jdW1lbnQiLCJydW4iLCIkcm9vdFNjb3BlIiwiJHN0YXRlIiwiJHRpbWVvdXQiLCIkcHJlbG9hZCIsImVuZEFuaW1hdGlvbiIsImxvYWRpbmciLCJtb2RhbERhdGEiLCIkIiwic2lkZU5hdiIsImNsb3NlT25DbGljayIsIiRvbiIsImV2dCIsInRvIiwicGFyYW1zIiwicmVkaXJlY3RUbyIsInByZXZlbnREZWZhdWx0IiwiZ28iLCJsb2NhdGlvbiIsImNvbmZpZyIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJodG1sNU1vZGUiLCJlbmFibGVkIiwicmVxdWlyZUJhc2UiLCJvdGhlcndpc2UiLCJzdGF0ZSIsInVybCIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsImRhdGEiLCJwYXJlbnQiLCJwcm9qZWN0IiwiJHNjb3BlIiwiJGpzb24iLCJsb2FkRmlsZSIsInN1Y2Nlc3MiLCJnZW5lcmFsSW5mbyIsImVycm9yIiwiY29uc29sZSIsImxvZyIsIndvcmtIaXN0b3J5IiwiY29sbGFwc2libGUiLCIkc3RhdGVQYXJhbXMiLCJzdHlsZSIsIm5vdGlmeSIsImdyaWRTdHlsZSIsInByb2plY3RMaXN0IiwiJHdhdGNoIiwibmV3VmFsIiwib2xkVmFsIiwiJHNjZSIsInRpdGxlIiwiZm9ybWF0VGl0bGUiLCJwcm9qZWN0TmFtZSIsInRoZW4iLCJyZXNwb25zZSIsImVycm9yUmVzcG9uc2UiLCJkaXJlY3RpdmUiLCJyZXN0cmljdCIsInJlcGxhY2UiLCJzY29wZSIsInRlbXBsYXRlIiwibGluayIsImVsZW1lbnQiLCJhdHRycyIsIndpbmRvdyIsInNjcm9sbCIsInRoaXMiLCJzY3JvbGxUb3AiLCJhZGRDbGFzcyIsInJlbW92ZUNsYXNzIiwid2lkdGgiLCJoZWlnaHQiLCJ0b1RvcCIsImFuaW1hdGUiLCIkaW50ZXJ2YWwiLCJpbWFnZUFycmF5Iiwic2VsZiIsInBhdXNlZCIsImNhcm91c2VsSW5kZXgiLCJjYXJvdXNlbFRpbWUiLCJpbml0IiwiY2Fyb3VzZWwiLCJjYW5jZWwiLCJsZW5ndGgiLCJuZXdWYWx1ZSIsInRvZ2dsZVBsYXliYWNrIiwiTGlzdCIsIlRpbGVzIiwidHJhbnNjbHVkZSIsInNldFN0eWxlIiwibmV3U3R5bGUiLCIkYW5pbWF0ZSIsImF0dHJpYnV0ZXMiLCJsZWF2ZSIsImNoaWxkcmVuIiwiZXEiLCJyZW1vdmUiLCJmaWx0ZXIiLCJ2YWwiLCJ0cnVzdEFzSHRtbCIsInNlcnZpY2UiLCIkaHR0cCIsInRvVGl0bGVDYXNlIiwic3RyIiwidHh0IiwiY2hhckF0IiwidG9VcHBlckNhc2UiLCJzdWJzdHIiLCJ0b0xvd2VyQ2FzZSIsInRlbXAiLCJmaWxlbmFtZSIsImdldCIsImFsZXJ0IiwiJHRlbXBsYXRlQ2FjaGUiLCJ2aWV3cyIsImpzb24iLCJwcm9qSnNvbiIsImxvYWRJbWFnZXMiLCJqc29uRmlsZSIsInByb21BcnJheSIsImkiLCJpbWFnZXMiLCJwcm9tIiwicHVzaCIsIlByb21pc2UiLCJhbGwiLCJsb2FkQWxsIiwibWFzdGVyUHJvbSIsInJlc29sdmUiLCJyZWplY3QiLCJ0aGlzZGlyIiwiaW1nUHJvbSIsInZhbHVlcyIsImVyciIsImZvckVhY2giLCJBcnJheSIsImlzQXJyYXkiLCJpbm5lclJlc3BvbnNlIiwicHV0Il0sIm1hcHBpbmdzIjoiQUFBQSxRQUFBQSxjQ0FBLEdBQUFDLEtBQUFDLFFBQUFDLE9BQUEsT0FBQSxZQUFBLGFBRUFDLFlBQ0EsV0FDQUYsUUFBQUcsVUFBQUMsVUFBQSxTQUNBLElBR0FMLElBQUFNLElBQUEsU0FBQUMsV0FBQUMsT0FBQUMsU0FBQUMsVUFFQUgsV0FBQUksY0FBQSxFQUVBRixTQUFBLFdBQ0FGLFdBQUFJLGNBQUEsR0FDQSxNQUVBSixXQUFBQyxPQUFBQSxPQUNBRCxXQUFBSyxTQUFBLEVBQ0FMLFdBQUFNLGFBQ0FDLEVBQUEsb0JBQUFDLFNBQ0FDLGNBQUEsSUFTQVQsV0FBQVUsSUFBQSxvQkFBQSxTQUFBQyxJQUFBQyxHQUFBQyxRQUNBRCxHQUFBRSxhQUNBSCxJQUFBSSxpQkFDQWQsT0FBQWUsR0FBQUosR0FBQUUsV0FBQUQsUUFDQUksU0FBQSxpQkFTQXhCLElBQUF5QixPQUFBLFNBQUFDLGVBQUFDLG1CQUFBQyxtQkFFQUEsa0JBQUFDLFdBQ0FDLFNBQUEsRUFDQUMsYUFBQSxJQUdBSixtQkFBQUssVUFBQSxLQUVBTixlQUNBTyxNQUFBLFFBQ0FDLElBQUEsSUFDQUMsWUFBQSxrQkFDQUMsV0FBQSxpQkFDQUMsVUFFQUosTUFBQSxTQUNBQyxJQUFBLFNBQ0FDLFlBQUEsbUJBQ0FDLFdBQUEsa0JBQ0FDLFVBRUFKLE1BQUEsY0FDQUMsSUFBQSxjQUNBQyxZQUFBLHdCQUNBQyxXQUFBLHVCQUNBQyxVQUVBSixNQUFB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R0FxRixlQUFBeUIsSUFBQXBGLFNBQUF0QyxPQUFBUyxJQUFBNkIsU0FBQTFCLFFBR0FvRyxRQUFBLFlBQ0EsU0FBQUssS0FDQWhHLFFBQUFDLElBQUErRixLQUNBTCxRQUFBSyxRQUlBLE9BQUFOIiwiZmlsZSI6ImFwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBHcmlkU3R5bGUoKSB7IH1cblxuR3JpZFN0eWxlLkxpc3QgPSAnbGlzdCc7XG5cbkdyaWRTdHlsZS5UaWxlcyA9ICdncmlkJztcblxuYXBwLmRpcmVjdGl2ZSgnZ3JpZCcsIGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0UnLFxuICAgIHJlcGxhY2U6IHRydWUsXG4gICAgdHJhbnNjbHVkZTogZmFsc2UsXG4gICAgc2NvcGU6IHtcbiAgICAgIGRhdGE6ICc9JyxcbiAgICAgIGdyaWRTdHlsZTogJz0nXG4gICAgfSxcbiAgICB0ZW1wbGF0ZVVybDogJy4vdmlld3MvZGlyZWN0aXZlcy9ncmlkLmh0bWwnLFxuICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycyl7XG4gICAgICBpZiAoIXNjb3BlLmdyaWRTdHlsZSl7XG4gICAgICAgIHNjb3BlLmdyaWRTdHlsZSA9IEdyaWRTdHlsZS5UaWxlcztcbiAgICAgIH1cbiAgICAgIFxuICAgICAgc2NvcGUuc2V0U3R5bGUgPSBmdW5jdGlvbihuZXdTdHlsZSkge1xuICAgICAgICBzY29wZS5ncmlkU3R5bGUgPSBuZXdTdHlsZTtcbiAgICAgIH07XG4gICAgICBcbiAgICB9XG4vLyAgICBjb250cm9sbGVyOiAnTmF2Q29udHJvbGxlcidcbiAgfVxufSk7IiwidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbJ3VpLnJvdXRlcicsICduZ0FuaW1hdGUnXSk7XG5cbnNldFRpbWVvdXQoXG4gIGZ1bmN0aW9uIGFzeW5jQm9vdHN0cmFwKCkge1xuICAgIGFuZ3VsYXIuYm9vdHN0cmFwKGRvY3VtZW50LCBbXCJhcHBcIl0pO1xuICB9LCAoMTApXG4pO1xuXG5hcHAucnVuKGZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkc3RhdGUsICR0aW1lb3V0LCAkcHJlbG9hZCkge1xuICBcbiAgJHJvb3RTY29wZS5lbmRBbmltYXRpb24gPSBmYWxzZTtcblxuICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgJHJvb3RTY29wZS5lbmRBbmltYXRpb24gPSB0cnVlO1xuICB9LCAzMzAwKTsgLy8zLjNzZWNcblxuICAkcm9vdFNjb3BlLiRzdGF0ZSA9ICRzdGF0ZTtcbiAgJHJvb3RTY29wZS5sb2FkaW5nID0gZmFsc2U7XG4gICRyb290U2NvcGUubW9kYWxEYXRhID0ge307XG4gICQoXCIuYnV0dG9uLWNvbGxhcHNlXCIpLnNpZGVOYXYoe1xuICAgIGNsb3NlT25DbGljazogdHJ1ZVxuICB9KTtcblxuLy8gICRwcmVsb2FkLmxvYWRBbGwoKS50aGVuKGZ1bmN0aW9uIChzdWNjZXNzKSB7XG4vLyAgICBjb25zb2xlLmxvZyhcIlByZWxvYWRcIiwgc3VjY2Vzcyk7XG4vLyAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4vLyAgICBjb25zb2xlLmxvZyhcIlByZWxvYWRcIiwgZXJyb3IpO1xuLy8gIH0pO1xuXG4gICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdGFydCcsIGZ1bmN0aW9uIChldnQsIHRvLCBwYXJhbXMpIHtcbiAgICBpZiAodG8ucmVkaXJlY3RUbykge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAkc3RhdGUuZ28odG8ucmVkaXJlY3RUbywgcGFyYW1zLCB7XG4gICAgICAgIGxvY2F0aW9uOiAncmVwbGFjZSdcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG59KTtcblxuXG4vKiAtLS0gUm91dGluZyAtLS0gKi9cblxuYXBwLmNvbmZpZyhmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIpIHtcblxuICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUoe1xuICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgcmVxdWlyZUJhc2U6IHRydWVcbiAgfSk7XG5cbiAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZShcIi9cIik7XG5cbiAgJHN0YXRlUHJvdmlkZXJcbiAgICAuc3RhdGUoJ0hvbWUnLCB7XG4gICAgICB1cmw6ICcvJyxcbiAgICAgIHRlbXBsYXRlVXJsOiBcInZpZXdzL2hvbWUuaHRtbFwiLFxuICAgICAgY29udHJvbGxlcjogJ0hvbWVDb250cm9sbGVyJyxcbiAgICAgIGRhdGE6IHt9XG4gICAgfSlcbiAgICAuc3RhdGUoJ0Fib3V0Jywge1xuICAgICAgdXJsOiAnL2Fib3V0JyxcbiAgICAgIHRlbXBsYXRlVXJsOiBcInZpZXdzL2Fib3V0Lmh0bWxcIixcbiAgICAgIGNvbnRyb2xsZXI6ICdBYm91dENvbnRyb2xsZXInLFxuICAgICAgZGF0YToge31cbiAgICB9KVxuICAgIC5zdGF0ZSgnRXhwZXJpZW5jZScsIHtcbiAgICAgIHVybDogJy9leHBlcmllbmNlJyxcbiAgICAgIHRlbXBsYXRlVXJsOiBcInZpZXdzL2V4cGVyaWVuY2UuaHRtbFwiLFxuICAgICAgY29udHJvbGxlcjogJ0V4cGVyaWVuY2VDb250cm9sbGVyJyxcbiAgICAgIGRhdGE6IHt9XG4gICAgfSlcbiAgICAuc3RhdGUoJ1Byb2plY3RzJywge1xuICAgICAgdXJsOiBcIi9wcm9qZWN0c1wiLFxuICAgICAgdGVtcGxhdGVVcmw6IFwidmlld3MvcHJvamVjdHMuaHRtbFwiLFxuICAgICAgY29udHJvbGxlcjogJ1Byb2plY3RzQ29udHJvbGxlcicsXG4gICAgICByZWRpcmVjdFRvOiAnUHJvamVjdHMuQWxsJyxcbiAgICAgIGRhdGE6IHt9XG4gICAgfSlcbiAgICAuc3RhdGUoJ1Byb2plY3RzLkFsbCcsIHtcbiAgICAgIHBhcmVudDogJ1Byb2plY3RzJyxcbiAgICAgIHByb2plY3Q6ICcvYWxsJyxcbiAgICAgIHVybDogXCIvYWxsP3N0eWxlXCIsXG4gICAgICB0ZW1wbGF0ZVVybDogXCJ2aWV3cy9wcm9qZWN0cy9hbGwuaHRtbFwiLFxuICAgICAgY29udHJvbGxlcjogJ1Byb2plY3RzQWxsQ29udHJvbGxlcicsXG4gICAgICBkYXRhOiB7fVxuICAgIH0pXG4gICAgLnN0YXRlKCdQcm9qZWN0cy5EZXRhaWwnLCB7XG4gICAgICBwYXJlbnQ6ICdQcm9qZWN0cycsXG4gICAgICB1cmw6IFwiLzpwcm9qZWN0TmFtZVwiLFxuICAgICAgdGVtcGxhdGVVcmw6IFwidmlld3MvcHJvamVjdHMvZGV0YWlscy5odG1sXCIsXG4gICAgICBjb250cm9sbGVyOiAnUHJvamVjdHNEZXRhaWxzQ29udHJvbGxlcicsXG4gICAgICBkYXRhOiB7fVxuICAgIH0pO1xufSk7IiwiYXBwLmNvbnRyb2xsZXIoJ0Fib3V0Q29udHJvbGxlcicsIGZ1bmN0aW9uICgkc2NvcGUsICRqc29uKSB7XG5cbiAgJGpzb24ubG9hZEZpbGUoJ2luZm9ybWF0aW9uL2dlbmVyYWwnKVxuICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAkc2NvcGUuZ2VuZXJhbEluZm8gPSBkYXRhO1xuICAgIH0pXG4gICAgLmVycm9yKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgIH0pO1xuXG59KTsiLCJhcHAuY29udHJvbGxlcignRXhwZXJpZW5jZUNvbnRyb2xsZXInLCBmdW5jdGlvbiAoJHNjb3BlLCAkanNvbikge1xuICAkanNvbi5sb2FkRmlsZSgnaW5mb3JtYXRpb24vd29yaycpXG4gICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICRzY29wZS53b3JrSGlzdG9yeSA9IGRhdGE7XG4gICAgICAkKCcuY29sbGFwc2libGUnKS5jb2xsYXBzaWJsZSgpO1xuICAgIH0pXG4gICAgLmVycm9yKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgIH0pO1xufSk7IiwiYXBwLmNvbnRyb2xsZXIoJ0hvbWVDb250cm9sbGVyJywgZnVuY3Rpb24oJHNjb3BlKXtcbiAgXG59KTsiLCJhcHAuY29udHJvbGxlcignTmF2Q29udHJvbGxlcicsIGZ1bmN0aW9uICgkc2NvcGUpIHtcblxuICAkKFwiLmJ1dHRvbi1jb2xsYXBzZVwiKS5zaWRlTmF2KHtcbiAgICBjbG9zZU9uQ2xpY2s6IHRydWVcbiAgfSk7XG5cbn0pOyIsImFwcC5jb250cm9sbGVyKCdQcm9qZWN0c0FsbENvbnRyb2xsZXInLCBmdW5jdGlvbiAoJHNjb3BlLCAkanNvbiwgJHN0YXRlUGFyYW1zLCAkc3RhdGUpIHtcblxuICBpZiAoISRzdGF0ZVBhcmFtcy5zdHlsZSB8fCAkc3RhdGVQYXJhbXMuc3R5bGUgPT0gXCJcIikge1xuICAgICRzdGF0ZVBhcmFtcy5zdHlsZSA9ICd0aWxlcyc7XG5cbiAgICAkc3RhdGUuZ28oJ1Byb2plY3RzLkFsbCcsIHtcbiAgICAgIHN0eWxlOiAkc3RhdGVQYXJhbXMuc3R5bGVcbiAgICB9LCB7XG4gICAgICBub3RpZnk6IGZhbHNlLFxuICAgICAgbG9jYXRpb246IFwicmVwbGFjZVwiXG4gICAgfSk7XG5cbiAgfTtcbiAgJHNjb3BlLmdyaWRTdHlsZSA9ICRzdGF0ZVBhcmFtcy5zdHlsZTtcblxuICAkanNvbi5sb2FkRmlsZSgncHJvamVjdHMnKVxuICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAkc2NvcGUucHJvamVjdExpc3QgPSBkYXRhO1xuICAgIH0pXG4gICAgLmVycm9yKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgIH0pO1xuXG5cbiAgJHNjb3BlLiR3YXRjaCgnZ3JpZFN0eWxlJywgZnVuY3Rpb24gKG5ld1ZhbCwgb2xkVmFsKSB7XG4gICAgaWYgKG5ld1ZhbCAhPSBvbGRWYWwpIHtcbiAgICAgICRzdGF0ZS5nbygnUHJvamVjdHMuQWxsJywge1xuICAgICAgICBzdHlsZTogbmV3VmFsXG4gICAgICB9LCB7XG4gICAgICAgIG5vdGlmeTogZmFsc2UsXG4gICAgICAgIGxvY2F0aW9uOiBcInJlcGxhY2VcIlxuICAgICAgfSk7XG4gICAgfVxuICB9KTtcblxuXG59KTsiLCJhcHAuY29udHJvbGxlcignUHJvamVjdHNDb250cm9sbGVyJywgZnVuY3Rpb24gKCRzY29wZSwgJGpzb24pIHtcblxufSk7IiwiYXBwLmNvbnRyb2xsZXIoJ1Byb2plY3RzRGV0YWlsc0NvbnRyb2xsZXInLCBmdW5jdGlvbiAoJHNjb3BlLCAkc3RhdGVQYXJhbXMsICRqc29uLCAkc2NlKSB7XG5cbiAgdmFyIHRpdGxlID0gJGpzb24uZm9ybWF0VGl0bGUoJHN0YXRlUGFyYW1zLnByb2plY3ROYW1lKTtcblxuICAkanNvbi5sb2FkRmlsZShcInByb2plY3RzL1wiICsgdGl0bGUpXG4gICAgLnRoZW4oZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3BvbnNlKSB7XG4gICAgICAkc2NvcGUucHJvamVjdCA9IHJlc3BvbnNlLmRhdGE7XG4gICAgfSwgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgJGpzb24uZXJyb3JSZXNwb25zZShyZXNwb25zZSk7XG4gICAgfSk7XG5cblxuXG59KTsiLCJhcHAuZGlyZWN0aXZlKCdiYWNrVG9Ub3AnLCBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdFJ1xuICAgICwgcmVwbGFjZTogdHJ1ZVxuICAgICwgc2NvcGU6IHt9XG4gICAgLCB0ZW1wbGF0ZTogJzxkaXYgaWQ9XCJnb1RvVG9wXCIgY2xhc3M9XCJidG4gYnRuLWZsb2F0aW5nIHdhdmVzLWVmZmVjdCB3YXZlcy1saWdodFwiIG5nLWNsaWNrPVwidG9Ub3AoKVwiPjxpIGNsYXNzPVwibWF0ZXJpYWwtaWNvbnNcIj5rZXlib2FyZF9hcnJvd191cDwvaT48L2Rpdj4nXG4gICAgLCBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG4gICAgICAkKHdpbmRvdykuc2Nyb2xsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCQodGhpcykuc2Nyb2xsVG9wKCkgPiAxMDApIHtcbiAgICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdzaG93Jyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcygnc2hvdycpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAoJCh3aW5kb3cpLndpZHRoKCkgPD0gNzUwKSB7XG4gICAgICAgICAgaWYgKCQodGhpcykuc2Nyb2xsVG9wKCkgPj0gJCh3aW5kb3cpLmhlaWdodCgpIC0gMSkge1xuICAgICAgICAgICAgZWxlbWVudC5hZGRDbGFzcygndXBmaXgnKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCd1cGZpeCcpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCd1cGZpeCcpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHNjb3BlLnRvVG9wID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkKFwiaHRtbCwgYm9keVwiKS5hbmltYXRlKHtcbiAgICAgICAgICBzY3JvbGxUb3A6IDBcbiAgICAgICAgfSwgNjAwKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfTtcbiAgICB9XG4gIH1cbn0pOyIsImFwcC5kaXJlY3RpdmUoJ2Nhcm91c2VsJywgZnVuY3Rpb24gKCRpbnRlcnZhbCkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgcmVwbGFjZTogdHJ1ZSxcbiAgICBzY29wZToge1xuICAgICAgaW1hZ2VBcnJheTogJz0nXG4gICAgfSxcbiAgICB0ZW1wbGF0ZVVybDogJy4vdmlld3MvZGlyZWN0aXZlcy9jYXJvdXNlbC5odG1sJyxcbiAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG5cbiAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgIFxuICAgICAgc2NvcGUucGF1c2VkID0gZmFsc2U7XG4gICAgICBcbi8vICAgICAgc2NvcGUuZnVsbFNjcmVlbiA9IGZhbHNlO1xuXG4gICAgICBzY29wZS5jYXJvdXNlbEluZGV4ID0gMDtcblxuICAgICAgdmFyIGNhcm91c2VsVGltZSA9IDQ1MDA7XG5cbiAgICAgIHZhciBpbml0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoc2VsZi5jYXJvdXNlbCkge1xuICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwoc2VsZi5jYXJvdXNlbCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHNlbGYuY2Fyb3VzZWwgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGlmIChzY29wZS5wYXVzZWQpe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBzY29wZS5jYXJvdXNlbEluZGV4ICs9IDE7XG4gICAgICAgICAgaWYgKHNjb3BlLmltYWdlQXJyYXkubGVuZ3RoID09IHNjb3BlLmNhcm91c2VsSW5kZXgpIHtcbiAgICAgICAgICAgIHNjb3BlLmNhcm91c2VsSW5kZXggPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgY2Fyb3VzZWxUaW1lKTtcbiAgICAgIH1cblxuICAgICAgc2NvcGUuJHdhdGNoKCdpbWFnZUFycmF5JywgZnVuY3Rpb24gKG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmIChuZXdWYWx1ZSkge1xuICAgICAgICAgIGluaXQoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cblxuICAgICAgLyoqXG4gICAgICAgKiBUb2dnbGUgUGxheWJhY2sgZnVuY3Rpb24sIHN0YXJ0cy9wYXVzZXMgY2Fyb3VzZWxcbiAgICAgICAqIEBhdXRob3IgQnJhbmRvbiBHcm9mZlxuICAgICAgICovXG4gICAgICBzY29wZS50b2dnbGVQbGF5YmFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc2NvcGUucGF1c2VkID0gIXNjb3BlLnBhdXNlZDtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLyoqXG4gICAgICAgKiBUb2dnbGUgRnVsbFNjcmVlbiBmdW5jdGlvbiwgZXhwYW5kcy9zaHJpbmtzIGNhcm91c2VsXG4gICAgICAgKiBAYXV0aG9yIEJyYW5kb24gR3JvZmZcbiAgICAgICAqL1xuLy8gICAgICBzY29wZS50b2dnbGVGdWxsc2NyZWVuID0gZnVuY3Rpb24gKCkge1xuLy8gICAgICAgIHNjb3BlLmZ1bGxTY3JlZW4gPSAhc2NvcGUuZnVsbFNjcmVlbjtcbi8vICAgICAgfVxuXG4gICAgfVxuICB9XG59KTsiLCJhcHAuZGlyZWN0aXZlKCdncmlkTGlzdCcsIGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0UnLFxuICAgIHJlcGxhY2U6IHRydWUsXG4gICAgc2NvcGU6IHtcbiAgICAgIHByb2plY3Q6ICc9J1xuICAgIH0sXG4gICAgdGVtcGxhdGVVcmw6ICcuL3ZpZXdzL2RpcmVjdGl2ZXMvZ3JpZC1saXN0Lmh0bWwnLFxuICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycyl7XG4gICAgICBcbiAgICB9XG4gIH1cbn0pOyIsImFwcC5kaXJlY3RpdmUoJ2dyaWRUaWxlJywgZnVuY3Rpb24gKCkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnRScsXG4gICAgcmVwbGFjZTogdHJ1ZSxcbiAgICBzY29wZToge1xuICAgICAgcHJvamVjdDogJz0nXG4gICAgfSxcbiAgICB0ZW1wbGF0ZVVybDogJy4vdmlld3MvZGlyZWN0aXZlcy9ncmlkLXRpbGUuaHRtbCcsXG4gICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzKXtcbiAgICAgIFxuICAgIH1cbiAgfVxufSk7IiwiYXBwLmRpcmVjdGl2ZShcIm1BcHBMb2FkaW5nXCIsIGZ1bmN0aW9uICgkYW5pbWF0ZSwgJHJvb3RTY29wZSkge1xuXG4gIGZ1bmN0aW9uIGxpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHJpYnV0ZXMpIHtcbiAgICAvLyBEdWUgdG8gdGhlIHdheSBBbmd1bGFySlMgcHJldmVudHMgYW5pbWF0aW9uIGR1cmluZyB0aGUgYm9vdHN0cmFwXG4gICAgLy8gb2YgdGhlIGFwcGxpY2F0aW9uLCB3ZSBjYW4ndCBhbmltYXRlIHRoZSB0b3AtbGV2ZWwgY29udGFpbmVyOyBidXQsXG4gICAgLy8gc2luY2Ugd2UgYWRkZWQgXCJuZ0FuaW1hdGVDaGlsZHJlblwiLCB3ZSBjYW4gYW5pbWF0ZWQgdGhlIGlubmVyXG4gICAgLy8gY29udGFpbmVyIGR1cmluZyB0aGlzIHBoYXNlLlxuICAgIC8vIC0tXG4gICAgLy8gTk9URTogQW0gdXNpbmcgLmVxKDEpIHNvIHRoYXQgd2UgZG9uJ3QgYW5pbWF0ZSB0aGUgU3R5bGUgYmxvY2suXG4gICAgJGFuaW1hdGUuZW5hYmxlZCh0cnVlKTtcblxuICAgICRyb290U2NvcGUuJHdhdGNoKCdlbmRBbmltYXRpb24nLCBmdW5jdGlvbiAobmV3VmFsKSB7XG4gICAgICBpZiAobmV3VmFsKSB7XG4gICAgICAgICRhbmltYXRlLmxlYXZlKGVsZW1lbnQuY2hpbGRyZW4oKS5lcSgxKSkudGhlbihcbiAgICAgICAgICBmdW5jdGlvbiBjbGVhbnVwQWZ0ZXJBbmltYXRpb24oKSB7XG4gICAgICAgICAgICAvLyBSZW1vdmUgdGhlIHJvb3QgZGlyZWN0aXZlIGVsZW1lbnQuXG4gICAgICAgICAgICBlbGVtZW50LnJlbW92ZSgpO1xuICAgICAgICAgICAgLy8gQ2xlYXIgdGhlIGNsb3NlZC1vdmVyIHZhcmlhYmxlIHJlZmVyZW5jZXMuXG4gICAgICAgICAgICBzY29wZSA9IGVsZW1lbnQgPSBhdHRyaWJ1dGVzID0gbnVsbDtcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgfTtcblxuXG4gIC8vIFJldHVybiB0aGUgZGlyZWN0aXZlIGNvbmZpZ3VyYXRpb24uXG4gIHJldHVybiAoe1xuICAgIGxpbms6IGxpbmssXG4gICAgcmVzdHJpY3Q6IFwiQ1wiXG4gIH0pO1xuICAvLyBJIGJpbmQgdGhlIEphdmFTY3JpcHQgZXZlbnRzIHRvIHRoZSBzY29wZS5cblxufSk7IiwiYXBwLmRpcmVjdGl2ZSgnbmF2aWdhdGlvbicsIGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0UnLFxuICAgIHRyYW5zY2x1ZGU6IGZhbHNlLFxuICAgIHNjb3BlOiB7XG4gICAgICBwcm9qZWN0OiBcIj1cIlxuICAgIH0sXG4gICAgdGVtcGxhdGVVcmw6ICcuL3ZpZXdzL2RpcmVjdGl2ZXMvbmF2aWdhdGlvbi5odG1sJyxcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpe1xuICAgICAgXG4gICAgfSxcbiAgICBjb250cm9sbGVyOiAnTmF2Q29udHJvbGxlcidcbiAgfVxufSk7IiwiYXBwLmZpbHRlcigncmF3SHRtbCcsIFsnJHNjZScsIGZ1bmN0aW9uICgkc2NlKSB7XG4gIHJldHVybiBmdW5jdGlvbiAodmFsKSB7XG4gICAgcmV0dXJuICRzY2UudHJ1c3RBc0h0bWwodmFsKTtcbiAgfTtcbn1dKTsiLCJhcHAuc2VydmljZShcIiRqc29uXCIsIGZ1bmN0aW9uICgkaHR0cCkge1xuXG4gIHZhciBsb2NhdGlvbiA9IFwianNvbi9cIjtcblxuICB2YXIgdG9UaXRsZUNhc2UgPSBmdW5jdGlvbiAoc3RyKSB7XG4gICAgcmV0dXJuIHN0ci5yZXBsYWNlKC9cXHdcXFMqL2csIGZ1bmN0aW9uICh0eHQpIHtcbiAgICAgIHJldHVybiB0eHQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyB0eHQuc3Vic3RyKDEpLnRvTG93ZXJDYXNlKCk7XG4gICAgfSk7XG4gIH1cblxuICB0aGlzLmZvcm1hdFRpdGxlID0gZnVuY3Rpb24gKHRpdGxlKSB7XG4gICAgdmFyIHRlbXAgPSB0b1RpdGxlQ2FzZSh0aXRsZSk7XG4gICAgdGVtcCA9IHRlbXAucmVwbGFjZSgvIC9nLCBcIlwiKTtcbiAgICB0ZW1wID0gdGVtcC5yZXBsYWNlKFwiKFwiLCBcIlwiKTtcbiAgICB0ZW1wID0gdGVtcC5yZXBsYWNlKFwiKVwiLCBcIlwiKTtcbiAgICB0ZW1wID0gdGVtcC5yZXBsYWNlKC8tL2csIFwiXCIpO1xuICAgIHJldHVybiB0ZW1wO1xuICB9XG5cbiAgdGhpcy5sb2FkRmlsZSA9IGZ1bmN0aW9uIChmaWxlbmFtZSkge1xuICAgIHJldHVybiAkaHR0cC5nZXQobG9jYXRpb24gKyBmaWxlbmFtZSArIFwiLmpzb25cIik7XG4gIH1cblxuICB0aGlzLmVycm9yUmVzcG9uc2UgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICBhbGVydChcIkFuIGVycm9yIG9jY3VyZWQgbG9hZGluZyB0aGUgcmVtb3RlIGRhdGEuIFBsZWFzZSByZWxvYWQgdGhlIHBhZ2UgdG8gdHJ5IGFnYWluLlwiKTtcbiAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gIH1cbn0pOyIsImFwcC5zZXJ2aWNlKFwiJHByZWxvYWRcIiwgZnVuY3Rpb24gKCR0ZW1wbGF0ZUNhY2hlLCAkaHR0cCkge1xuXG4gIHZhciBzZWxmID0gdGhpcztcblxuICB2YXIgdmlld3MgPSBbXG4gICAgJ2Fib3V0JyxcbiAgICAnZXhwZXJpZW5jZScsXG4gICAgJ2hvbWUnLFxuICAgICdwcm9qZWN0cycsXG4gICAgJ2RpcmVjdGl2ZXMvY2Fyb3VzZWwnLFxuICAgICdkaXJlY3RpdmVzL2dyaWQtbGlzdCcsXG4gICAgJ2RpcmVjdGl2ZXMvZ3JpZC10aWxlJyxcbiAgICAnZGlyZWN0aXZlcy9ncmlkJyxcbiAgICAnZGlyZWN0aXZlcy9uYXZpZ2F0aW9uJyxcbiAgICAncHJvamVjdHMvYWxsJyxcbiAgICAncHJvamVjdHMvZGV0YWlscydcbiAgXTtcblxuICB2YXIganNvbiA9IFtcbiAgICAnaW5mb3JtYXRpb24vZ2VuZXJhbCcsXG4vLyAgICAnaW5mb3JtYXRpb24vaW50ZXJlc3RzJyxcbi8vICAgICdpbmZvcm1hdGlvbi9wZXJzb25hbGl0eVRyYWl0cycsXG4vLyAgICAnaW5mb3JtYXRpb24vc2tpbGxzJyxcbiAgICAnaW5mb3JtYXRpb24vd29yaycsXG4vLyAgICAnb2xkUHJvamVjdHMnLFxuICAgICdwcm9qZWN0cydcbiAgXTtcblxuICB2YXIgcHJvakpzb24gPSBbXG4gICAgJ3Byb2plY3RzL0FzdGVyb2lkQmxhc3RlcicsXG4vLyAgICAncHJvamVjdHMvQXVnbWVudGVkUmVhbGl0eVNjYXZlbmdlckh1bnQnLFxuLy8gICAgJ3Byb2plY3RzL0JvbWJuYW56YScsXG4vLyAgICAncHJvamVjdHMvQnV6emVkQnVkZHknLFxuICAgICdwcm9qZWN0cy9DaGFybGllRWF0c1dvcm1zJyxcbi8vICAgICdwcm9qZWN0cy9Db2RlT2ZLbmlnaHRob2RkJyxcbiAgICAncHJvamVjdHMvR29kZXgnLFxuICAgICdwcm9qZWN0cy9IYWNrb2xhbnRlcm4nLFxuICAgICdwcm9qZWN0cy9JbmJldHdlZW4nLFxuLy8gICAgJ3Byb2plY3RzL0luYmV0d2VlbmlvcycsXG4vLyAgICAncHJvamVjdHMvTWN2ZXJpbG9nJyxcbi8vICAgICdwcm9qZWN0cy9QbGFudHNJblNwYWNlJyxcbiAgICAncHJvamVjdHMvUGxleG1lZGlhU2VydmVyJyxcbiAgICAncHJvamVjdHMvUG9rZW1vbmRiJyxcbiAgICAncHJvamVjdHMvU2ltcGxlU3R1ZGVudERiJyxcbiAgICAncHJvamVjdHMvU2tidXR0b24nLFxuICAgICdwcm9qZWN0cy9WaXJ0dWFsQ29tbWVuY2VtZW50QWRtaW4nLFxuICAgICdwcm9qZWN0cy9XaWZpdXNiJ1xuICBdXG5cblxuICAvKipcbiAgICogTG9hZCBhbGwgaW1hZ2VzIGZyb20gdGhlIGpzb25cbiAgICogQGF1dGhvciBCcmFuZG9uIEdyb2ZmXG4gICAqIEBwYXJhbSB7T2JqZWN0fSAganNvbkZpbGUgdGhlIGxvYWRlZCBqc29uIGZpbGVcbiAgICogQHJldHVybnMge1Byb21pc2V9IGEgcHJvbWlzZVxuICAgKi9cbiAgdmFyIGxvYWRJbWFnZXMgPSBmdW5jdGlvbiAoanNvbkZpbGUpIHtcbiAgICB2YXIgcHJvbUFycmF5ID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBqc29uRmlsZS5pbWFnZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciB1cmwgPSBqc29uRmlsZS5pbWFnZXNbaV07XG4gICAgICB2YXIgcHJvbSA9ICRodHRwLmdldCgnL2Fzc2V0cy9wcm9qZWN0cy8nICsgdXJsKTtcbiAgICAgIHByb21BcnJheS5wdXNoKHByb20pO1xuICAgIH1cbiAgICByZXR1cm4gUHJvbWlzZS5hbGwocHJvbUFycmF5KTtcbiAgfTtcblxuICAvKipcbiAgICogTG9hZCBhbGwgdGVtcGxhdGUgaHRtbCxqc29uLCBhbmQgaW1hZ2UgZmlsZXMgZm9yIGZ1dHVyZSB1c2VcbiAgICogQGF1dGhvciBCcmFuZG9uIEdyb2ZmXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfSBBIFByb21pc2UgdGhhdCBhbHdheXMgcmVzb2x2ZXMgc3VjY2Vzc2Z1bGx5XG4gICAqL1xuICB0aGlzLmxvYWRBbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG1hc3RlclByb20gPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgIHZhciBwcm9tQXJyYXkgPSBbXTtcblxuICAgICAgLy9WaWV3c1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2aWV3cy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgdGhpc2RpciA9IHZpZXdzW2ldO1xuICAgICAgICB2YXIgcHJvbSA9ICRodHRwLmdldCgndmlld3MvJyArIHRoaXNkaXIgKyAnLmh0bWwnKTtcbiAgICAgICAgcHJvbUFycmF5LnB1c2gocHJvbSk7XG4gICAgICB9XG5cbiAgICAgIC8vUHJvakpTT05cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvakpzb24ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIHRoaXNkaXIgPSBwcm9qSnNvbltpXTtcbiAgICAgICAgdmFyIHByb20gPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgJGh0dHAuZ2V0KCdqc29uLycgKyB0aGlzZGlyICsgJy5qc29uJylcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAvL0ltYWdlc1xuICAgICAgICAgICAgICB2YXIgaW1nUHJvbSA9IGxvYWRJbWFnZXMocmVzcG9uc2UuZGF0YSk7XG4gICAgICAgICAgICAgIGltZ1Byb20udGhlbihmdW5jdGlvbih2YWx1ZXMpIHtcbiAgICAgICAgICAgICAgICAvL2FkZCB0aGlzIGl0ZW0gb3IgaXQgd29uJ3QgZ2V0IGNhY2hlZFxuICAgICAgICAgICAgICAgIHZhbHVlcy5wdXNoKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHZhbHVlcyk7XG4gICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHByb21BcnJheS5wdXNoKHByb20pO1xuICAgICAgfVxuXG4gICAgICAvL0pTT05cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwganNvbi5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgdGhpc2RpciA9IGpzb25baV07XG4gICAgICAgIHZhciBwcm9tID0gJGh0dHAuZ2V0KCdqc29uLycgKyB0aGlzZGlyICsgJy5qc29uJyk7XG4gICAgICAgIHByb21BcnJheS5wdXNoKHByb20pO1xuICAgICAgfVxuXG4gICAgICAvL0ZJTkFMTFkgLT4gc2F2ZSB0aGVtIEFMTExMXG4gICAgICBQcm9taXNlLmFsbChwcm9tQXJyYXkpLnRoZW4oZnVuY3Rpb24odmFsdWVzKSB7XG4gICAgICAgIHZhbHVlcy5mb3JFYWNoKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHJlc3BvbnNlKSkge1xuICAgICAgICAgICAgcmVzcG9uc2UuZm9yRWFjaChmdW5jdGlvbiAoaW5uZXJSZXNwb25zZSkge1xuICAgICAgICAgICAgICAkdGVtcGxhdGVDYWNoZS5wdXQoaW5uZXJSZXNwb25zZS5jb25maWcudXJsLCBpbm5lclJlc3BvbnNlLmRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICR0ZW1wbGF0ZUNhY2hlLnB1dChyZXNwb25zZS5jb25maWcudXJsLCByZXNwb25zZS5kYXRhKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXNvbHZlKCdTdWNjZXNzJyk7XG4gICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgcmVzb2x2ZShlcnIpO1xuICAgICAgfSk7XG5cbiAgICB9KTtcbiAgICByZXR1cm4gbWFzdGVyUHJvbTtcbiAgfTtcblxufSk7Il19
