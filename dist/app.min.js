function GridStyle(){}var app=angular.module("app",["ui.router","ngAnimate"]);setTimeout(function(){angular.bootstrap(document,["app"])},10),app.run(function($rootScope,$state,$timeout,$preload){$rootScope.endAnimation=!1,$timeout(function(){$rootScope.endAnimation=!0},3300),$rootScope.$state=$state,$rootScope.loading=!1,$rootScope.modalData={},$(".button-collapse").sideNav({closeOnClick:!0}),$rootScope.$on("$stateChangeStart",function(evt,to,params){to.redirectTo&&(evt.preventDefault(),$state.go(to.redirectTo,params,{location:"replace"}))})}),app.config(function($stateProvider,$urlRouterProvider,$locationProvider){$locationProvider.html5Mode({enabled:!0,requireBase:!0}),$urlRouterProvider.otherwise("/"),$stateProvider.state("Home",{url:"/",templateUrl:"views/home.html",controller:"HomeController",data:{}}).state("About",{url:"/about",templateUrl:"views/about.html",controller:"AboutController",data:{}}).state("Experience",{url:"/experience",templateUrl:"views/experience.html",controller:"ExperienceController",data:{}}).state("Projects",{url:"/projects",templateUrl:"views/projects.html",controller:"ProjectsController",redirectTo:"Projects.All",data:{}}).state("Projects.All",{parent:"Projects",project:"/all",url:"/all?style",templateUrl:"views/projects/all.html",controller:"ProjectsAllController",data:{}}).state("Projects.Detail",{parent:"Projects",url:"/:projectName",templateUrl:"views/projects/details.html",controller:"ProjectsDetailsController",data:{}})}),app.directive("backToTop",function(){return{restrict:"E",replace:!0,scope:{},template:'<div id="goToTop" class="btn btn-floating waves-effect waves-light" ng-click="toTop()"><i class="material-icons">keyboard_arrow_up</i></div>',link:function(scope,element,attrs){$(window).scroll(function(){$(this).scrollTop()>100?element.addClass("show"):element.removeClass("show"),$(window).width()<=750&&$(this).scrollTop()>=$(window).height()-1?element.addClass("upfix"):element.removeClass("upfix")}),scope.toTop=function(){return $("html, body").animate({scrollTop:0},600),!1}}}}),app.directive("carousel",function($interval){return{restrict:"A",replace:!0,scope:{imageArray:"="},templateUrl:"./views/directives/carousel.html",link:function(scope,element,attrs){var self=this;scope.paused=!1,scope.carouselIndex=0;var carouselTime=4500,init=function(){self.carousel&&$interval.cancel(self.carousel),self.carousel=$interval(function(){scope.paused||(scope.carouselIndex+=1,scope.imageArray.length==scope.carouselIndex&&(scope.carouselIndex=0))},carouselTime)};scope.$watch("imageArray",function(newValue){newValue&&init()}),scope.togglePlayback=function(){scope.paused=!scope.paused}}}}),GridStyle.List="list",GridStyle.Tiles="grid",app.directive("grid",function(){return{restrict:"E",replace:!0,transclude:!1,scope:{data:"=",gridStyle:"="},templateUrl:"./views/directives/grid.html",link:function(scope,element,attrs){scope.gridStyle||(scope.gridStyle=GridStyle.Tiles),scope.setStyle=function(newStyle){scope.gridStyle=newStyle}}}}),app.directive("gridList",function(){return{restrict:"E",replace:!0,scope:{project:"="},templateUrl:"./views/directives/grid-list.html",link:function(scope,element,attrs){}}}),app.directive("gridTile",function(){return{restrict:"E",replace:!0,scope:{project:"="},templateUrl:"./views/directives/grid-tile.html",link:function(scope,element,attrs){}}}),app.directive("mAppLoading",function($animate,$rootScope){function link(scope,element,attributes){$animate.enabled(!0),$rootScope.$watch("endAnimation",function(newVal){newVal&&$animate.leave(element.children().eq(1)).then(function(){element.remove(),scope=element=attributes=null})})}return{link:link,restrict:"C"}}),app.directive("navigation",function(){return{restrict:"E",transclude:!1,scope:{project:"="},templateUrl:"./views/directives/navigation.html",link:function(scope,element,attrs){},controller:"NavController"}}),app.controller("AboutController",function($scope,$json){$json.loadFile("information/general").success(function(data){$scope.generalInfo=data}).error(function(error){console.log(error)})}),app.controller("ExperienceController",function($scope,$json){$json.loadFile("information/work").success(function(data){$scope.workHistory=data,$(".collapsible").collapsible()}).error(function(error){console.log(error)})}),app.controller("HomeController",function($scope){}),app.controller("NavController",function($scope){$(".button-collapse").sideNav({closeOnClick:!0})}),app.controller("ProjectsAllController",function($scope,$json,$stateParams,$state){$stateParams.style&&""!=$stateParams.style||($stateParams.style="tiles",$state.go("Projects.All",{style:$stateParams.style},{notify:!1,location:"replace"})),$scope.gridStyle=$stateParams.style,$json.loadFile("projects").success(function(data){$scope.projectList=data}).error(function(error){console.log(error)}),$scope.$watch("gridStyle",function(newVal,oldVal){newVal!=oldVal&&$state.go("Projects.All",{style:newVal},{notify:!1,location:"replace"})})}),app.controller("ProjectsController",function($scope,$json){}),app.controller("ProjectsDetailsController",function($scope,$stateParams,$json,$sce){var title=$json.formatTitle($stateParams.projectName);$json.loadFile("projects/"+title).then(function(response){$scope.project=response.data},function(response){$json.errorResponse(response)})}),app.filter("rawHtml",["$sce",function($sce){return function(val){return $sce.trustAsHtml(val)}}]),app.service("$json",function($http){var location="json/",toTitleCase=function(str){return str.replace(/\w\S*/g,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase()})};this.formatTitle=function(title){var temp=toTitleCase(title);return temp=temp.replace(/ /g,""),temp=temp.replace("(",""),temp=temp.replace(")",""),temp=temp.replace(/-/g,"")},this.loadFile=function(filename){return $http.get(location+filename+".json")},this.errorResponse=function(error){alert("An error occured loading the remote data. Please reload the page to try again."),console.log(error)}}),app.service("$preload",function($templateCache,$http){var views=["about","experience","home","projects","directives/carousel","directives/grid-list","directives/grid-tile","directives/grid","directives/navigation","projects/all","projects/details"],json=["information/general","information/work","projects"],projJson=["projects/AsteroidBlaster","projects/CharlieEatsWorms","projects/Godex","projects/Hackolantern","projects/Inbetween","projects/PlexmediaServer","projects/Pokemondb","projects/SimpleStudentDb","projects/Skbutton","projects/VirtualCommencementAdmin","projects/Wifiusb"],loadImages=function(jsonFile){for(var promArray=[],i=0;i<jsonFile.images.length;i++){var url=jsonFile.images[i],prom=$http.get("/assets/projects/"+url);promArray.push(prom)}return Promise.all(promArray)};this.loadAll=function(){var masterProm=new Promise(function(resolve,reject){for(var promArray=[],i=0;i<views.length;i++){var thisdir=views[i],prom=$http.get("views/"+thisdir+".html");promArray.push(prom)}for(var i=0;i<projJson.length;i++){var thisdir=projJson[i],prom=new Promise(function(resolve,reject){$http.get("json/"+thisdir+".json").then(function(response){var imgProm=loadImages(response.data);imgProm.then(function(values){values.push(response),resolve(values)},function(err){reject(err)})},function(error){reject(error)})});promArray.push(prom)}for(var i=0;i<json.length;i++){var thisdir=json[i],prom=$http.get("json/"+thisdir+".json");promArray.push(prom)}Promise.all(promArray).then(function(values){values.forEach(function(response){Array.isArray(response)?response.forEach(function(innerResponse){$templateCache.put(innerResponse.config.url,innerResponse.data)}):$templateCache.put(response.config.url,response.data)}),resolve("Success")},function(err){console.log(err),resolve(err)})});return masterProm}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRpcmVjdGl2ZXMvZ3JpZC5qcyIsImFwcC5qcyIsImRpcmVjdGl2ZXMvYmFja1RvVG9wLmpzIiwiZGlyZWN0aXZlcy9jYXJvdXNlbC5qcyIsImRpcmVjdGl2ZXMvZ3JpZExpc3QuanMiLCJkaXJlY3RpdmVzL2dyaWRUaWxlLmpzIiwiZGlyZWN0aXZlcy9tQXBwTG9hZGluZy5qcyIsImRpcmVjdGl2ZXMvbmF2aWdhdGlvbi5qcyIsImNvbnRyb2xsZXJzL0Fib3V0Q29udHJvbGxlci5qcyIsImNvbnRyb2xsZXJzL0V4cGVyaWVuY2VDb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvSG9tZUNvbnRyb2xsZXIuanMiLCJjb250cm9sbGVycy9OYXZDb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvUHJvamVjdHNBbGxDb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvUHJvamVjdHNDb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvUHJvamVjdHNEZXRhaWxzQ29udHJvbGxlci5qcyIsImZpbHRlcnMvcmF3SHRtbC5qcyIsInNlcnZpY2VzL2pzb24uanMiLCJzZXJ2aWNlcy9wcmVsb2FkLmpzIl0sIm5hbWVzIjpbIkdyaWRTdHlsZSIsImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJzZXRUaW1lb3V0IiwiYm9vdHN0cmFwIiwiZG9jdW1lbnQiLCJydW4iLCIkcm9vdFNjb3BlIiwiJHN0YXRlIiwiJHRpbWVvdXQiLCIkcHJlbG9hZCIsImVuZEFuaW1hdGlvbiIsImxvYWRpbmciLCJtb2RhbERhdGEiLCIkIiwic2lkZU5hdiIsImNsb3NlT25DbGljayIsIiRvbiIsImV2dCIsInRvIiwicGFyYW1zIiwicmVkaXJlY3RUbyIsInByZXZlbnREZWZhdWx0IiwiZ28iLCJsb2NhdGlvbiIsImNvbmZpZyIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJodG1sNU1vZGUiLCJlbmFibGVkIiwicmVxdWlyZUJhc2UiLCJvdGhlcndpc2UiLCJzdGF0ZSIsInVybCIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsImRhdGEiLCJwYXJlbnQiLCJwcm9qZWN0IiwiZGlyZWN0aXZlIiwicmVzdHJpY3QiLCJyZXBsYWNlIiwic2NvcGUiLCJ0ZW1wbGF0ZSIsImxpbmsiLCJlbGVtZW50IiwiYXR0cnMiLCJ3aW5kb3ciLCJzY3JvbGwiLCJ0aGlzIiwic2Nyb2xsVG9wIiwiYWRkQ2xhc3MiLCJyZW1vdmVDbGFzcyIsIndpZHRoIiwiaGVpZ2h0IiwidG9Ub3AiLCJhbmltYXRlIiwiJGludGVydmFsIiwiaW1hZ2VBcnJheSIsInNlbGYiLCJwYXVzZWQiLCJjYXJvdXNlbEluZGV4IiwiY2Fyb3VzZWxUaW1lIiwiaW5pdCIsImNhcm91c2VsIiwiY2FuY2VsIiwibGVuZ3RoIiwiJHdhdGNoIiwibmV3VmFsdWUiLCJ0b2dnbGVQbGF5YmFjayIsIkxpc3QiLCJUaWxlcyIsInRyYW5zY2x1ZGUiLCJncmlkU3R5bGUiLCJzZXRTdHlsZSIsIm5ld1N0eWxlIiwiJGFuaW1hdGUiLCJhdHRyaWJ1dGVzIiwibmV3VmFsIiwibGVhdmUiLCJjaGlsZHJlbiIsImVxIiwidGhlbiIsInJlbW92ZSIsIiRzY29wZSIsIiRqc29uIiwibG9hZEZpbGUiLCJzdWNjZXNzIiwiZ2VuZXJhbEluZm8iLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJ3b3JrSGlzdG9yeSIsImNvbGxhcHNpYmxlIiwiJHN0YXRlUGFyYW1zIiwic3R5bGUiLCJub3RpZnkiLCJwcm9qZWN0TGlzdCIsIm9sZFZhbCIsIiRzY2UiLCJ0aXRsZSIsImZvcm1hdFRpdGxlIiwicHJvamVjdE5hbWUiLCJyZXNwb25zZSIsImVycm9yUmVzcG9uc2UiLCJmaWx0ZXIiLCJ2YWwiLCJ0cnVzdEFzSHRtbCIsInNlcnZpY2UiLCIkaHR0cCIsInRvVGl0bGVDYXNlIiwic3RyIiwidHh0IiwiY2hhckF0IiwidG9VcHBlckNhc2UiLCJzdWJzdHIiLCJ0b0xvd2VyQ2FzZSIsInRlbXAiLCJmaWxlbmFtZSIsImdldCIsImFsZXJ0IiwiJHRlbXBsYXRlQ2FjaGUiLCJ2aWV3cyIsImpzb24iLCJwcm9qSnNvbiIsImxvYWRJbWFnZXMiLCJqc29uRmlsZSIsInByb21BcnJheSIsImkiLCJpbWFnZXMiLCJwcm9tIiwicHVzaCIsIlByb21pc2UiLCJhbGwiLCJsb2FkQWxsIiwibWFzdGVyUHJvbSIsInJlc29sdmUiLCJyZWplY3QiLCJ0aGlzZGlyIiwiaW1nUHJvbSIsInZhbHVlcyIsImVyciIsImZvckVhY2giLCJBcnJheSIsImlzQXJyYXkiLCJpbm5lclJlc3BvbnNlIiwicHV0Il0sIm1hcHBpbmdzIjoiQUFBQSxRQUFBQSxjQ0FBLEdBQUFDLEtBQUFDLFFBQUFDLE9BQUEsT0FBQSxZQUFBLGFBRUFDLFlBQ0EsV0FDQUYsUUFBQUcsVUFBQUMsVUFBQSxTQUNBLElBR0FMLElBQUFNLElBQUEsU0FBQUMsV0FBQUMsT0FBQUMsU0FBQUMsVUFFQUgsV0FBQUksY0FBQSxFQUVBRixTQUFBLFdBQ0FGLFdBQUFJLGNBQUEsR0FDQSxNQUVBSixXQUFBQyxPQUFBQSxPQUNBRCxXQUFBSyxTQUFBLEVBQ0FMLFdBQUFNLGFBQ0FDLEVBQUEsb0JBQUFDLFNBQ0FDLGNBQUEsSUFTQVQsV0FBQVUsSUFBQSxvQkFBQSxTQUFBQyxJQUFBQyxHQUFBQyxRQUNBRCxHQUFBRSxhQUNBSCxJQUFBSSxpQkFDQWQsT0FBQWUsR0FBQUosR0FBQUUsV0FBQUQsUUFDQUksU0FBQSxpQkFTQXhCLElBQUF5QixPQUFBLFNBQUFDLGVBQUFDLG1CQUFBQyxtQkFFQUEsa0JBQUFDLFdBQ0FDLFNBQUEsRUFDQUMsYUFBQSxJQUdBSixtQkFBQUssVUFBQSxLQUVBTixlQUNBTyxNQUFBLFFBQ0FDLElBQUEsSUFDQUMsWUFBQSxrQkFDQUMsV0FBQSxpQkFDQUMsVUFFQUosTUFBQSxTQUNBQyxJQUFBLFNBQ0FDLFlBQUEsbUJBQ0FDLFdBQUEsa0JBQ0FDLFVBRUFKLE1BQUEsY0FDQUMsSUFBQSxjQUNBQyxZQUFBLHdCQUNBQyxXQUFBLHVCQUNBQyxVQUVBSixNQUFB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QWdILGNBQUE3RyxRQUdBcUYsZUFBQXlCLElBQUEzQyxTQUFBL0UsT0FBQVMsSUFBQXNFLFNBQUFuRSxRQUdBb0csUUFBQSxZQUNBLFNBQUFLLEtBQ0FuRCxRQUFBQyxJQUFBa0QsS0FDQUwsUUFBQUssUUFJQSxPQUFBTiIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gR3JpZFN0eWxlKCkgeyB9XG5cbkdyaWRTdHlsZS5MaXN0ID0gJ2xpc3QnO1xuXG5HcmlkU3R5bGUuVGlsZXMgPSAnZ3JpZCc7XG5cbmFwcC5kaXJlY3RpdmUoJ2dyaWQnLCBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdFJyxcbiAgICByZXBsYWNlOiB0cnVlLFxuICAgIHRyYW5zY2x1ZGU6IGZhbHNlLFxuICAgIHNjb3BlOiB7XG4gICAgICBkYXRhOiAnPScsXG4gICAgICBncmlkU3R5bGU6ICc9J1xuICAgIH0sXG4gICAgdGVtcGxhdGVVcmw6ICcuL3ZpZXdzL2RpcmVjdGl2ZXMvZ3JpZC5odG1sJyxcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpe1xuICAgICAgaWYgKCFzY29wZS5ncmlkU3R5bGUpe1xuICAgICAgICBzY29wZS5ncmlkU3R5bGUgPSBHcmlkU3R5bGUuVGlsZXM7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHNjb3BlLnNldFN0eWxlID0gZnVuY3Rpb24obmV3U3R5bGUpIHtcbiAgICAgICAgc2NvcGUuZ3JpZFN0eWxlID0gbmV3U3R5bGU7XG4gICAgICB9O1xuICAgICAgXG4gICAgfVxuLy8gICAgY29udHJvbGxlcjogJ05hdkNvbnRyb2xsZXInXG4gIH1cbn0pOyIsInZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJywgWyd1aS5yb3V0ZXInLCAnbmdBbmltYXRlJ10pO1xuXG5zZXRUaW1lb3V0KFxuICBmdW5jdGlvbiBhc3luY0Jvb3RzdHJhcCgpIHtcbiAgICBhbmd1bGFyLmJvb3RzdHJhcChkb2N1bWVudCwgW1wiYXBwXCJdKTtcbiAgfSwgKDEwKVxuKTtcblxuYXBwLnJ1bihmdW5jdGlvbiAoJHJvb3RTY29wZSwgJHN0YXRlLCAkdGltZW91dCwgJHByZWxvYWQpIHtcbiAgXG4gICRyb290U2NvcGUuZW5kQW5pbWF0aW9uID0gZmFsc2U7XG5cbiAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICRyb290U2NvcGUuZW5kQW5pbWF0aW9uID0gdHJ1ZTtcbiAgfSwgMzMwMCk7IC8vMy4zc2VjXG5cbiAgJHJvb3RTY29wZS4kc3RhdGUgPSAkc3RhdGU7XG4gICRyb290U2NvcGUubG9hZGluZyA9IGZhbHNlO1xuICAkcm9vdFNjb3BlLm1vZGFsRGF0YSA9IHt9O1xuICAkKFwiLmJ1dHRvbi1jb2xsYXBzZVwiKS5zaWRlTmF2KHtcbiAgICBjbG9zZU9uQ2xpY2s6IHRydWVcbiAgfSk7XG5cbi8vICAkcHJlbG9hZC5sb2FkQWxsKCkudGhlbihmdW5jdGlvbiAoc3VjY2Vzcykge1xuLy8gICAgY29uc29sZS5sb2coXCJQcmVsb2FkXCIsIHN1Y2Nlc3MpO1xuLy8gIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuLy8gICAgY29uc29sZS5sb2coXCJQcmVsb2FkXCIsIGVycm9yKTtcbi8vICB9KTtcblxuICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3RhcnQnLCBmdW5jdGlvbiAoZXZ0LCB0bywgcGFyYW1zKSB7XG4gICAgaWYgKHRvLnJlZGlyZWN0VG8pIHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgJHN0YXRlLmdvKHRvLnJlZGlyZWN0VG8sIHBhcmFtcywge1xuICAgICAgICBsb2NhdGlvbjogJ3JlcGxhY2UnXG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xufSk7XG5cblxuLyogLS0tIFJvdXRpbmcgLS0tICovXG5cbmFwcC5jb25maWcoZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XG5cbiAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHtcbiAgICBlbmFibGVkOiB0cnVlLFxuICAgIHJlcXVpcmVCYXNlOiB0cnVlXG4gIH0pO1xuXG4gICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoXCIvXCIpO1xuXG4gICRzdGF0ZVByb3ZpZGVyXG4gICAgLnN0YXRlKCdIb21lJywge1xuICAgICAgdXJsOiAnLycsXG4gICAgICB0ZW1wbGF0ZVVybDogXCJ2aWV3cy9ob21lLmh0bWxcIixcbiAgICAgIGNvbnRyb2xsZXI6ICdIb21lQ29udHJvbGxlcicsXG4gICAgICBkYXRhOiB7fVxuICAgIH0pXG4gICAgLnN0YXRlKCdBYm91dCcsIHtcbiAgICAgIHVybDogJy9hYm91dCcsXG4gICAgICB0ZW1wbGF0ZVVybDogXCJ2aWV3cy9hYm91dC5odG1sXCIsXG4gICAgICBjb250cm9sbGVyOiAnQWJvdXRDb250cm9sbGVyJyxcbiAgICAgIGRhdGE6IHt9XG4gICAgfSlcbiAgICAuc3RhdGUoJ0V4cGVyaWVuY2UnLCB7XG4gICAgICB1cmw6ICcvZXhwZXJpZW5jZScsXG4gICAgICB0ZW1wbGF0ZVVybDogXCJ2aWV3cy9leHBlcmllbmNlLmh0bWxcIixcbiAgICAgIGNvbnRyb2xsZXI6ICdFeHBlcmllbmNlQ29udHJvbGxlcicsXG4gICAgICBkYXRhOiB7fVxuICAgIH0pXG4gICAgLnN0YXRlKCdQcm9qZWN0cycsIHtcbiAgICAgIHVybDogXCIvcHJvamVjdHNcIixcbiAgICAgIHRlbXBsYXRlVXJsOiBcInZpZXdzL3Byb2plY3RzLmh0bWxcIixcbiAgICAgIGNvbnRyb2xsZXI6ICdQcm9qZWN0c0NvbnRyb2xsZXInLFxuICAgICAgcmVkaXJlY3RUbzogJ1Byb2plY3RzLkFsbCcsXG4gICAgICBkYXRhOiB7fVxuICAgIH0pXG4gICAgLnN0YXRlKCdQcm9qZWN0cy5BbGwnLCB7XG4gICAgICBwYXJlbnQ6ICdQcm9qZWN0cycsXG4gICAgICBwcm9qZWN0OiAnL2FsbCcsXG4gICAgICB1cmw6IFwiL2FsbD9zdHlsZVwiLFxuICAgICAgdGVtcGxhdGVVcmw6IFwidmlld3MvcHJvamVjdHMvYWxsLmh0bWxcIixcbiAgICAgIGNvbnRyb2xsZXI6ICdQcm9qZWN0c0FsbENvbnRyb2xsZXInLFxuICAgICAgZGF0YToge31cbiAgICB9KVxuICAgIC5zdGF0ZSgnUHJvamVjdHMuRGV0YWlsJywge1xuICAgICAgcGFyZW50OiAnUHJvamVjdHMnLFxuICAgICAgdXJsOiBcIi86cHJvamVjdE5hbWVcIixcbiAgICAgIHRlbXBsYXRlVXJsOiBcInZpZXdzL3Byb2plY3RzL2RldGFpbHMuaHRtbFwiLFxuICAgICAgY29udHJvbGxlcjogJ1Byb2plY3RzRGV0YWlsc0NvbnRyb2xsZXInLFxuICAgICAgZGF0YToge31cbiAgICB9KTtcbn0pOyIsImFwcC5kaXJlY3RpdmUoJ2JhY2tUb1RvcCcsIGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0UnXG4gICAgLCByZXBsYWNlOiB0cnVlXG4gICAgLCBzY29wZToge31cbiAgICAsIHRlbXBsYXRlOiAnPGRpdiBpZD1cImdvVG9Ub3BcIiBjbGFzcz1cImJ0biBidG4tZmxvYXRpbmcgd2F2ZXMtZWZmZWN0IHdhdmVzLWxpZ2h0XCIgbmctY2xpY2s9XCJ0b1RvcCgpXCI+PGkgY2xhc3M9XCJtYXRlcmlhbC1pY29uc1wiPmtleWJvYXJkX2Fycm93X3VwPC9pPjwvZGl2PidcbiAgICAsIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICQod2luZG93KS5zY3JvbGwoZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoJCh0aGlzKS5zY3JvbGxUb3AoKSA+IDEwMCkge1xuICAgICAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoJ3Nob3cnKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCdzaG93Jyk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmICgkKHdpbmRvdykud2lkdGgoKSA8PSA3NTApIHtcbiAgICAgICAgICBpZiAoJCh0aGlzKS5zY3JvbGxUb3AoKSA+PSAkKHdpbmRvdykuaGVpZ2h0KCkgLSAxKSB7XG4gICAgICAgICAgICBlbGVtZW50LmFkZENsYXNzKCd1cGZpeCcpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ3VwZml4Jyk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ3VwZml4Jyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgc2NvcGUudG9Ub3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICQoXCJodG1sLCBib2R5XCIpLmFuaW1hdGUoe1xuICAgICAgICAgIHNjcm9sbFRvcDogMFxuICAgICAgICB9LCA2MDApO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9O1xuICAgIH1cbiAgfVxufSk7IiwiYXBwLmRpcmVjdGl2ZSgnY2Fyb3VzZWwnLCBmdW5jdGlvbiAoJGludGVydmFsKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdBJyxcbiAgICByZXBsYWNlOiB0cnVlLFxuICAgIHNjb3BlOiB7XG4gICAgICBpbWFnZUFycmF5OiAnPSdcbiAgICB9LFxuICAgIHRlbXBsYXRlVXJsOiAnLi92aWV3cy9kaXJlY3RpdmVzL2Nhcm91c2VsLmh0bWwnLFxuICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcblxuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgXG4gICAgICBzY29wZS5wYXVzZWQgPSBmYWxzZTtcbiAgICAgIFxuLy8gICAgICBzY29wZS5mdWxsU2NyZWVuID0gZmFsc2U7XG5cbiAgICAgIHNjb3BlLmNhcm91c2VsSW5kZXggPSAwO1xuXG4gICAgICB2YXIgY2Fyb3VzZWxUaW1lID0gNDUwMDtcblxuICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChzZWxmLmNhcm91c2VsKSB7XG4gICAgICAgICAgJGludGVydmFsLmNhbmNlbChzZWxmLmNhcm91c2VsKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgc2VsZi5jYXJvdXNlbCA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgaWYgKHNjb3BlLnBhdXNlZCl7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIHNjb3BlLmNhcm91c2VsSW5kZXggKz0gMTtcbiAgICAgICAgICBpZiAoc2NvcGUuaW1hZ2VBcnJheS5sZW5ndGggPT0gc2NvcGUuY2Fyb3VzZWxJbmRleCkge1xuICAgICAgICAgICAgc2NvcGUuY2Fyb3VzZWxJbmRleCA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICB9LCBjYXJvdXNlbFRpbWUpO1xuICAgICAgfVxuXG4gICAgICBzY29wZS4kd2F0Y2goJ2ltYWdlQXJyYXknLCBmdW5jdGlvbiAobmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKG5ld1ZhbHVlKSB7XG4gICAgICAgICAgaW5pdCgpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuXG4gICAgICAvKipcbiAgICAgICAqIFRvZ2dsZSBQbGF5YmFjayBmdW5jdGlvbiwgc3RhcnRzL3BhdXNlcyBjYXJvdXNlbFxuICAgICAgICogQGF1dGhvciBCcmFuZG9uIEdyb2ZmXG4gICAgICAgKi9cbiAgICAgIHNjb3BlLnRvZ2dsZVBsYXliYWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBzY29wZS5wYXVzZWQgPSAhc2NvcGUucGF1c2VkO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvKipcbiAgICAgICAqIFRvZ2dsZSBGdWxsU2NyZWVuIGZ1bmN0aW9uLCBleHBhbmRzL3Nocmlua3MgY2Fyb3VzZWxcbiAgICAgICAqIEBhdXRob3IgQnJhbmRvbiBHcm9mZlxuICAgICAgICovXG4vLyAgICAgIHNjb3BlLnRvZ2dsZUZ1bGxzY3JlZW4gPSBmdW5jdGlvbiAoKSB7XG4vLyAgICAgICAgc2NvcGUuZnVsbFNjcmVlbiA9ICFzY29wZS5mdWxsU2NyZWVuO1xuLy8gICAgICB9XG5cbiAgICB9XG4gIH1cbn0pOyIsImFwcC5kaXJlY3RpdmUoJ2dyaWRMaXN0JywgZnVuY3Rpb24gKCkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnRScsXG4gICAgcmVwbGFjZTogdHJ1ZSxcbiAgICBzY29wZToge1xuICAgICAgcHJvamVjdDogJz0nXG4gICAgfSxcbiAgICB0ZW1wbGF0ZVVybDogJy4vdmlld3MvZGlyZWN0aXZlcy9ncmlkLWxpc3QuaHRtbCcsXG4gICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzKXtcbiAgICAgIFxuICAgIH1cbiAgfVxufSk7IiwiYXBwLmRpcmVjdGl2ZSgnZ3JpZFRpbGUnLCBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdFJyxcbiAgICByZXBsYWNlOiB0cnVlLFxuICAgIHNjb3BlOiB7XG4gICAgICBwcm9qZWN0OiAnPSdcbiAgICB9LFxuICAgIHRlbXBsYXRlVXJsOiAnLi92aWV3cy9kaXJlY3RpdmVzL2dyaWQtdGlsZS5odG1sJyxcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpe1xuICAgICAgXG4gICAgfVxuICB9XG59KTsiLCJhcHAuZGlyZWN0aXZlKFwibUFwcExvYWRpbmdcIiwgZnVuY3Rpb24gKCRhbmltYXRlLCAkcm9vdFNjb3BlKSB7XG5cbiAgZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbWVudCwgYXR0cmlidXRlcykge1xuICAgIC8vIER1ZSB0byB0aGUgd2F5IEFuZ3VsYXJKUyBwcmV2ZW50cyBhbmltYXRpb24gZHVyaW5nIHRoZSBib290c3RyYXBcbiAgICAvLyBvZiB0aGUgYXBwbGljYXRpb24sIHdlIGNhbid0IGFuaW1hdGUgdGhlIHRvcC1sZXZlbCBjb250YWluZXI7IGJ1dCxcbiAgICAvLyBzaW5jZSB3ZSBhZGRlZCBcIm5nQW5pbWF0ZUNoaWxkcmVuXCIsIHdlIGNhbiBhbmltYXRlZCB0aGUgaW5uZXJcbiAgICAvLyBjb250YWluZXIgZHVyaW5nIHRoaXMgcGhhc2UuXG4gICAgLy8gLS1cbiAgICAvLyBOT1RFOiBBbSB1c2luZyAuZXEoMSkgc28gdGhhdCB3ZSBkb24ndCBhbmltYXRlIHRoZSBTdHlsZSBibG9jay5cbiAgICAkYW5pbWF0ZS5lbmFibGVkKHRydWUpO1xuXG4gICAgJHJvb3RTY29wZS4kd2F0Y2goJ2VuZEFuaW1hdGlvbicsIGZ1bmN0aW9uIChuZXdWYWwpIHtcbiAgICAgIGlmIChuZXdWYWwpIHtcbiAgICAgICAgJGFuaW1hdGUubGVhdmUoZWxlbWVudC5jaGlsZHJlbigpLmVxKDEpKS50aGVuKFxuICAgICAgICAgIGZ1bmN0aW9uIGNsZWFudXBBZnRlckFuaW1hdGlvbigpIHtcbiAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgcm9vdCBkaXJlY3RpdmUgZWxlbWVudC5cbiAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlKCk7XG4gICAgICAgICAgICAvLyBDbGVhciB0aGUgY2xvc2VkLW92ZXIgdmFyaWFibGUgcmVmZXJlbmNlcy5cbiAgICAgICAgICAgIHNjb3BlID0gZWxlbWVudCA9IGF0dHJpYnV0ZXMgPSBudWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICB9O1xuXG5cbiAgLy8gUmV0dXJuIHRoZSBkaXJlY3RpdmUgY29uZmlndXJhdGlvbi5cbiAgcmV0dXJuICh7XG4gICAgbGluazogbGluayxcbiAgICByZXN0cmljdDogXCJDXCJcbiAgfSk7XG4gIC8vIEkgYmluZCB0aGUgSmF2YVNjcmlwdCBldmVudHMgdG8gdGhlIHNjb3BlLlxuXG59KTsiLCJhcHAuZGlyZWN0aXZlKCduYXZpZ2F0aW9uJywgZnVuY3Rpb24gKCkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnRScsXG4gICAgdHJhbnNjbHVkZTogZmFsc2UsXG4gICAgc2NvcGU6IHtcbiAgICAgIHByb2plY3Q6IFwiPVwiXG4gICAgfSxcbiAgICB0ZW1wbGF0ZVVybDogJy4vdmlld3MvZGlyZWN0aXZlcy9uYXZpZ2F0aW9uLmh0bWwnLFxuICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycyl7XG4gICAgICBcbiAgICB9LFxuICAgIGNvbnRyb2xsZXI6ICdOYXZDb250cm9sbGVyJ1xuICB9XG59KTsiLCJhcHAuY29udHJvbGxlcignQWJvdXRDb250cm9sbGVyJywgZnVuY3Rpb24gKCRzY29wZSwgJGpzb24pIHtcblxuICAkanNvbi5sb2FkRmlsZSgnaW5mb3JtYXRpb24vZ2VuZXJhbCcpXG4gICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICRzY29wZS5nZW5lcmFsSW5mbyA9IGRhdGE7XG4gICAgfSlcbiAgICAuZXJyb3IoZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgfSk7XG5cbn0pOyIsImFwcC5jb250cm9sbGVyKCdFeHBlcmllbmNlQ29udHJvbGxlcicsIGZ1bmN0aW9uICgkc2NvcGUsICRqc29uKSB7XG4gICRqc29uLmxvYWRGaWxlKCdpbmZvcm1hdGlvbi93b3JrJylcbiAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgJHNjb3BlLndvcmtIaXN0b3J5ID0gZGF0YTtcbiAgICAgICQoJy5jb2xsYXBzaWJsZScpLmNvbGxhcHNpYmxlKCk7XG4gICAgfSlcbiAgICAuZXJyb3IoZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgfSk7XG59KTsiLCJhcHAuY29udHJvbGxlcignSG9tZUNvbnRyb2xsZXInLCBmdW5jdGlvbigkc2NvcGUpe1xuICBcbn0pOyIsImFwcC5jb250cm9sbGVyKCdOYXZDb250cm9sbGVyJywgZnVuY3Rpb24gKCRzY29wZSkge1xuXG4gICQoXCIuYnV0dG9uLWNvbGxhcHNlXCIpLnNpZGVOYXYoe1xuICAgIGNsb3NlT25DbGljazogdHJ1ZVxuICB9KTtcblxufSk7IiwiYXBwLmNvbnRyb2xsZXIoJ1Byb2plY3RzQWxsQ29udHJvbGxlcicsIGZ1bmN0aW9uICgkc2NvcGUsICRqc29uLCAkc3RhdGVQYXJhbXMsICRzdGF0ZSkge1xuXG4gIGlmICghJHN0YXRlUGFyYW1zLnN0eWxlIHx8ICRzdGF0ZVBhcmFtcy5zdHlsZSA9PSBcIlwiKSB7XG4gICAgJHN0YXRlUGFyYW1zLnN0eWxlID0gJ3RpbGVzJztcblxuICAgICRzdGF0ZS5nbygnUHJvamVjdHMuQWxsJywge1xuICAgICAgc3R5bGU6ICRzdGF0ZVBhcmFtcy5zdHlsZVxuICAgIH0sIHtcbiAgICAgIG5vdGlmeTogZmFsc2UsXG4gICAgICBsb2NhdGlvbjogXCJyZXBsYWNlXCJcbiAgICB9KTtcblxuICB9O1xuICAkc2NvcGUuZ3JpZFN0eWxlID0gJHN0YXRlUGFyYW1zLnN0eWxlO1xuXG4gICRqc29uLmxvYWRGaWxlKCdwcm9qZWN0cycpXG4gICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICRzY29wZS5wcm9qZWN0TGlzdCA9IGRhdGE7XG4gICAgfSlcbiAgICAuZXJyb3IoZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgfSk7XG5cblxuICAkc2NvcGUuJHdhdGNoKCdncmlkU3R5bGUnLCBmdW5jdGlvbiAobmV3VmFsLCBvbGRWYWwpIHtcbiAgICBpZiAobmV3VmFsICE9IG9sZFZhbCkge1xuICAgICAgJHN0YXRlLmdvKCdQcm9qZWN0cy5BbGwnLCB7XG4gICAgICAgIHN0eWxlOiBuZXdWYWxcbiAgICAgIH0sIHtcbiAgICAgICAgbm90aWZ5OiBmYWxzZSxcbiAgICAgICAgbG9jYXRpb246IFwicmVwbGFjZVwiXG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xuXG5cbn0pOyIsImFwcC5jb250cm9sbGVyKCdQcm9qZWN0c0NvbnRyb2xsZXInLCBmdW5jdGlvbiAoJHNjb3BlLCAkanNvbikge1xuXG59KTsiLCJhcHAuY29udHJvbGxlcignUHJvamVjdHNEZXRhaWxzQ29udHJvbGxlcicsIGZ1bmN0aW9uICgkc2NvcGUsICRzdGF0ZVBhcmFtcywgJGpzb24sICRzY2UpIHtcblxuICB2YXIgdGl0bGUgPSAkanNvbi5mb3JtYXRUaXRsZSgkc3RhdGVQYXJhbXMucHJvamVjdE5hbWUpO1xuXG4gICRqc29uLmxvYWRGaWxlKFwicHJvamVjdHMvXCIgKyB0aXRsZSlcbiAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICRzY29wZS5wcm9qZWN0ID0gcmVzcG9uc2UuZGF0YTtcbiAgICB9LCBmdW5jdGlvbiBlcnJvckNhbGxiYWNrKHJlc3BvbnNlKSB7XG4gICAgICAkanNvbi5lcnJvclJlc3BvbnNlKHJlc3BvbnNlKTtcbiAgICB9KTtcblxuXG5cbn0pOyIsImFwcC5maWx0ZXIoJ3Jhd0h0bWwnLCBbJyRzY2UnLCBmdW5jdGlvbiAoJHNjZSkge1xuICByZXR1cm4gZnVuY3Rpb24gKHZhbCkge1xuICAgIHJldHVybiAkc2NlLnRydXN0QXNIdG1sKHZhbCk7XG4gIH07XG59XSk7IiwiYXBwLnNlcnZpY2UoXCIkanNvblwiLCBmdW5jdGlvbiAoJGh0dHApIHtcblxuICB2YXIgbG9jYXRpb24gPSBcImpzb24vXCI7XG5cbiAgdmFyIHRvVGl0bGVDYXNlID0gZnVuY3Rpb24gKHN0cikge1xuICAgIHJldHVybiBzdHIucmVwbGFjZSgvXFx3XFxTKi9nLCBmdW5jdGlvbiAodHh0KSB7XG4gICAgICByZXR1cm4gdHh0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgdHh0LnN1YnN0cigxKS50b0xvd2VyQ2FzZSgpO1xuICAgIH0pO1xuICB9XG5cbiAgdGhpcy5mb3JtYXRUaXRsZSA9IGZ1bmN0aW9uICh0aXRsZSkge1xuICAgIHZhciB0ZW1wID0gdG9UaXRsZUNhc2UodGl0bGUpO1xuICAgIHRlbXAgPSB0ZW1wLnJlcGxhY2UoLyAvZywgXCJcIik7XG4gICAgdGVtcCA9IHRlbXAucmVwbGFjZShcIihcIiwgXCJcIik7XG4gICAgdGVtcCA9IHRlbXAucmVwbGFjZShcIilcIiwgXCJcIik7XG4gICAgdGVtcCA9IHRlbXAucmVwbGFjZSgvLS9nLCBcIlwiKTtcbiAgICByZXR1cm4gdGVtcDtcbiAgfVxuXG4gIHRoaXMubG9hZEZpbGUgPSBmdW5jdGlvbiAoZmlsZW5hbWUpIHtcbiAgICByZXR1cm4gJGh0dHAuZ2V0KGxvY2F0aW9uICsgZmlsZW5hbWUgKyBcIi5qc29uXCIpO1xuICB9XG5cbiAgdGhpcy5lcnJvclJlc3BvbnNlID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgYWxlcnQoXCJBbiBlcnJvciBvY2N1cmVkIGxvYWRpbmcgdGhlIHJlbW90ZSBkYXRhLiBQbGVhc2UgcmVsb2FkIHRoZSBwYWdlIHRvIHRyeSBhZ2Fpbi5cIik7XG4gICAgY29uc29sZS5sb2coZXJyb3IpO1xuICB9XG59KTsiLCJhcHAuc2VydmljZShcIiRwcmVsb2FkXCIsIGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSwgJGh0dHApIHtcblxuICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgdmFyIHZpZXdzID0gW1xuICAgICdhYm91dCcsXG4gICAgJ2V4cGVyaWVuY2UnLFxuICAgICdob21lJyxcbiAgICAncHJvamVjdHMnLFxuICAgICdkaXJlY3RpdmVzL2Nhcm91c2VsJyxcbiAgICAnZGlyZWN0aXZlcy9ncmlkLWxpc3QnLFxuICAgICdkaXJlY3RpdmVzL2dyaWQtdGlsZScsXG4gICAgJ2RpcmVjdGl2ZXMvZ3JpZCcsXG4gICAgJ2RpcmVjdGl2ZXMvbmF2aWdhdGlvbicsXG4gICAgJ3Byb2plY3RzL2FsbCcsXG4gICAgJ3Byb2plY3RzL2RldGFpbHMnXG4gIF07XG5cbiAgdmFyIGpzb24gPSBbXG4gICAgJ2luZm9ybWF0aW9uL2dlbmVyYWwnLFxuLy8gICAgJ2luZm9ybWF0aW9uL2ludGVyZXN0cycsXG4vLyAgICAnaW5mb3JtYXRpb24vcGVyc29uYWxpdHlUcmFpdHMnLFxuLy8gICAgJ2luZm9ybWF0aW9uL3NraWxscycsXG4gICAgJ2luZm9ybWF0aW9uL3dvcmsnLFxuLy8gICAgJ29sZFByb2plY3RzJyxcbiAgICAncHJvamVjdHMnXG4gIF07XG5cbiAgdmFyIHByb2pKc29uID0gW1xuICAgICdwcm9qZWN0cy9Bc3Rlcm9pZEJsYXN0ZXInLFxuLy8gICAgJ3Byb2plY3RzL0F1Z21lbnRlZFJlYWxpdHlTY2F2ZW5nZXJIdW50Jyxcbi8vICAgICdwcm9qZWN0cy9Cb21ibmFuemEnLFxuLy8gICAgJ3Byb2plY3RzL0J1enplZEJ1ZGR5JyxcbiAgICAncHJvamVjdHMvQ2hhcmxpZUVhdHNXb3JtcycsXG4vLyAgICAncHJvamVjdHMvQ29kZU9mS25pZ2h0aG9kZCcsXG4gICAgJ3Byb2plY3RzL0dvZGV4JyxcbiAgICAncHJvamVjdHMvSGFja29sYW50ZXJuJyxcbiAgICAncHJvamVjdHMvSW5iZXR3ZWVuJyxcbi8vICAgICdwcm9qZWN0cy9JbmJldHdlZW5pb3MnLFxuLy8gICAgJ3Byb2plY3RzL01jdmVyaWxvZycsXG4vLyAgICAncHJvamVjdHMvUGxhbnRzSW5TcGFjZScsXG4gICAgJ3Byb2plY3RzL1BsZXhtZWRpYVNlcnZlcicsXG4gICAgJ3Byb2plY3RzL1Bva2Vtb25kYicsXG4gICAgJ3Byb2plY3RzL1NpbXBsZVN0dWRlbnREYicsXG4gICAgJ3Byb2plY3RzL1NrYnV0dG9uJyxcbiAgICAncHJvamVjdHMvVmlydHVhbENvbW1lbmNlbWVudEFkbWluJyxcbiAgICAncHJvamVjdHMvV2lmaXVzYidcbiAgXVxuXG5cbiAgLyoqXG4gICAqIExvYWQgYWxsIGltYWdlcyBmcm9tIHRoZSBqc29uXG4gICAqIEBhdXRob3IgQnJhbmRvbiBHcm9mZlxuICAgKiBAcGFyYW0ge09iamVjdH0gIGpzb25GaWxlIHRoZSBsb2FkZWQganNvbiBmaWxlXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfSBhIHByb21pc2VcbiAgICovXG4gIHZhciBsb2FkSW1hZ2VzID0gZnVuY3Rpb24gKGpzb25GaWxlKSB7XG4gICAgdmFyIHByb21BcnJheSA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwganNvbkZpbGUuaW1hZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgdXJsID0ganNvbkZpbGUuaW1hZ2VzW2ldO1xuICAgICAgdmFyIHByb20gPSAkaHR0cC5nZXQoJy9hc3NldHMvcHJvamVjdHMvJyArIHVybCk7XG4gICAgICBwcm9tQXJyYXkucHVzaChwcm9tKTtcbiAgICB9XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKHByb21BcnJheSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIExvYWQgYWxsIHRlbXBsYXRlIGh0bWwsanNvbiwgYW5kIGltYWdlIGZpbGVzIGZvciBmdXR1cmUgdXNlXG4gICAqIEBhdXRob3IgQnJhbmRvbiBHcm9mZlxuICAgKiBAcmV0dXJucyB7UHJvbWlzZX0gQSBQcm9taXNlIHRoYXQgYWx3YXlzIHJlc29sdmVzIHN1Y2Nlc3NmdWxseVxuICAgKi9cbiAgdGhpcy5sb2FkQWxsID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBtYXN0ZXJQcm9tID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICB2YXIgcHJvbUFycmF5ID0gW107XG5cbiAgICAgIC8vVmlld3NcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmlld3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIHRoaXNkaXIgPSB2aWV3c1tpXTtcbiAgICAgICAgdmFyIHByb20gPSAkaHR0cC5nZXQoJ3ZpZXdzLycgKyB0aGlzZGlyICsgJy5odG1sJyk7XG4gICAgICAgIHByb21BcnJheS5wdXNoKHByb20pO1xuICAgICAgfVxuXG4gICAgICAvL1Byb2pKU09OXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb2pKc29uLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciB0aGlzZGlyID0gcHJvakpzb25baV07XG4gICAgICAgIHZhciBwcm9tID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICRodHRwLmdldCgnanNvbi8nICsgdGhpc2RpciArICcuanNvbicpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgLy9JbWFnZXNcbiAgICAgICAgICAgICAgdmFyIGltZ1Byb20gPSBsb2FkSW1hZ2VzKHJlc3BvbnNlLmRhdGEpO1xuICAgICAgICAgICAgICBpbWdQcm9tLnRoZW4oZnVuY3Rpb24odmFsdWVzKSB7XG4gICAgICAgICAgICAgICAgLy9hZGQgdGhpcyBpdGVtIG9yIGl0IHdvbid0IGdldCBjYWNoZWRcbiAgICAgICAgICAgICAgICB2YWx1ZXMucHVzaChyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh2YWx1ZXMpO1xuICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBwcm9tQXJyYXkucHVzaChwcm9tKTtcbiAgICAgIH1cblxuICAgICAgLy9KU09OXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGpzb24ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIHRoaXNkaXIgPSBqc29uW2ldO1xuICAgICAgICB2YXIgcHJvbSA9ICRodHRwLmdldCgnanNvbi8nICsgdGhpc2RpciArICcuanNvbicpO1xuICAgICAgICBwcm9tQXJyYXkucHVzaChwcm9tKTtcbiAgICAgIH1cblxuICAgICAgLy9GSU5BTExZIC0+IHNhdmUgdGhlbSBBTExMTFxuICAgICAgUHJvbWlzZS5hbGwocHJvbUFycmF5KS50aGVuKGZ1bmN0aW9uKHZhbHVlcykge1xuICAgICAgICB2YWx1ZXMuZm9yRWFjaChmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShyZXNwb25zZSkpIHtcbiAgICAgICAgICAgIHJlc3BvbnNlLmZvckVhY2goZnVuY3Rpb24gKGlubmVyUmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgJHRlbXBsYXRlQ2FjaGUucHV0KGlubmVyUmVzcG9uc2UuY29uZmlnLnVybCwgaW5uZXJSZXNwb25zZS5kYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkdGVtcGxhdGVDYWNoZS5wdXQocmVzcG9uc2UuY29uZmlnLnVybCwgcmVzcG9uc2UuZGF0YSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmVzb2x2ZSgnU3VjY2VzcycpO1xuICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgIHJlc29sdmUoZXJyKTtcbiAgICAgIH0pO1xuXG4gICAgfSk7XG4gICAgcmV0dXJuIG1hc3RlclByb207XG4gIH07XG5cbn0pOyJdfQ==
